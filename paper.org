# 基于火焰图像的炉膛燃烧稳定性定量分析
* 摘要
燃烧火焰是表征燃烧状态稳定与否的最直接反映，其稳定性检测与评价对锅炉的安全经济运行有着重要的作用。燃烧不稳定，会导致燃烧效率下降，产生更多的环境污染物、噪音等，更可能引起严重的事故，造成人员伤亡和财产损失。为了能及时、灵敏、可靠地检测炉内燃烧工况，防止在点火、低负荷等燃烧不稳定工况下发生炉膛爆炸、火焰刷墙，以及温度场分布异常等情况，电站锅炉必须配备功能齐全、性能可靠的炉膛安全监视系统，实时监测燃烧状态。另外，当燃烧器正常工作，由于火焰检测器误检而切断煤粉供给，同样会造成不必要的经济损失。因此为了能及时、灵敏、可靠地检测炉内燃烧工况，防止在点火、低负荷等燃烧不稳定工况下发生炉膛爆炸以及温度场分布异常等情况，对燃烧质量的正确评价显得尤为重要。在燃煤火电机组单机容量不断提高、参数不断增多、系统越来越复杂的情况下，基于炉膛燃烧火焰图像对电站锅炉燃烧优化控制和状态诊断问题进行研究，将为燃煤火电机组实现高效率、低污染排放、安全稳定运行提供有效解决方案。
首先，本文在某600MW燃煤机组进行燃烧调整实验，利用图像检测装置采集调整实验中稳定时段、变负荷、给煤量波动较大时段中不同燃烧状态下的火焰图像，对图像进行平滑处理后根据观察孔形状设定模板裁剪后压缩为符合卷积神经网络网络特性的火焰图像作为实验数据。
其次，利用变分自编码器采样快速、准确且易于与其他网络模型结合应用的优点，借助卷积神经网络在图像处理方面强大的提取能力，将二者相结合搭建了VAE-CNN网络模型，调整网络结构和参数，实现了对火焰图像的无监督特征提取，得到火焰图像的稀疏表示，并利用以均方误、峰值信噪比、结构相似度、多尺度结构相似度作为评判指标与相同结构的自编码器、稀疏自编码器进行对比分析，实验结果表明本文采用的网络模型能够更好地表征火焰图像的潜在特征。
再次，用主成分分析法对无监督提取的特征向量映射到正交空间中，提高算法的计算速度和抗干扰能力；运用k-means无监督聚类算法对映射到低维数据空间的特征向量进行聚类分析，将煤粉燃烧状态划分为稳定燃烧、不稳定燃烧、灭火3类不同的燃烧状态；然后，在无监督聚类燃烧状态划分的基础上，定义物理定量表征指标，对煤粉燃烧的动态过程进行质量描述，并结合对应给煤量变化情况进行分析，证实了所提出表征指标的合理性和可行性。
最后，采用时间序列分析方法长短时记忆网络和MultiRocket对无监督提取的特征向量进行实验分析。由于火焰图像本身是具有时间行为的数据，故将无监督提取的潜在特征封装为符合模型特性的时间序列输入到上述两种模型中，更大程度地挖掘数据本身的时间行为，实验结果表明，长短时记忆网络在数据集上取得良好效果，MultiRocket在训练集和测试集中均取得良好精度均达到了接近100% 的优异表现，且在训练时间成本耗费上也具有明显优势，完成了对燃烧状态的判别分析，证实了所提出的基于长短时记忆网络和MultiRocket的煤粉燃烧稳定性状态判别模型的可行性。
关键词：燃烧稳定性；定量分析；k-means；LSTM；MultiRocket
* 绪论
** 课题研究背景及意义
由中电联发布的2020 - 2021年度全国电力供需形势分析预测报告可知，2020年国内全年全社会用电量7.51万亿千瓦时，同比增长3.1%，综合考虑国内外经济形势，预计2021年电力消费将延续平稳增长态势，全社会用电量增长6% - 7%，预计年底发电装机容量23.7亿千瓦，同比增长7.7% 左右，风电和太阳能发电装机比重比2020年底提高3个百分点左右，其中火电仍将为最大占比，且在火电装机中，煤电所占比例仍为最大，对电力系统灵活性调节能力进一步增加[1]。根据2020年我国电力能源结构及电力行业碳排放占比可知，以燃煤为主的火电在我国电源构成中占比超过一半，虽然水电及各种新能源的占比接近于45%，但仍然无法代替火电在我国当前的电力能源结构中的巨大占比。近年来我国对经济能源结构进行了调整，风电、太阳能和核电等新能源占比上升明显，但仍处于大量开发阶段，其所接入电网的负荷量目前还远不能满足全国用电需求。煤炭作为我国的主要化石能源，燃煤电厂对煤炭的需求量占全国煤炭需求量的一半左右[2]。由此易知，火力发电在未来仍将占比较高，燃煤机组仍将占据主导地位。2021年是“十四五”规划的开局之年，全面推动煤电机组灵活性改造，提升燃煤机组运行稳定性效益性成为火力发电的重中之重。火焰稳定性是火焰稳定燃烧的基础，电站锅炉燃烧的基本要求是在炉膛内建立并维持稳定、均匀的燃烧火焰，燃烧火焰是表征燃烧状态稳定与否最直接的反映[3]。锅炉内煤粉的燃烧状态以火焰形式呈现最直观，而火焰燃烧稳定性直接影响燃烧是否安全，燃烧的不稳定将会破坏炉膛内部温度场的均匀性，不仅会降低锅炉热效率，产生污染物、噪声等，而且在极端情况下可能引起锅炉炉膛灭火，如若处理不当甚至会诱发炉膛爆燃造成事故，造成设备的严重损伤，对工作人员的人身安全带来危险，影响电厂运行的安全性和经济性。因此，如何准确地对炉内燃烧工况进行实时、可靠的监测，做出实时调整以保证低负荷机组稳定运行，是有效地避免在燃烧不稳定工况下发生炉膛爆炸及温度场分布异常等安全事故的有效手段[4]。为了预防这种潜在的危险必须进行切实有效的火焰检测和燃烧诊断，研究燃烧系统火焰稳定性，达到最优的燃烧过程，降低污染物排放，提升电厂的安全运营。
目前，基于图像的火焰状态识别可采集到较多火焰特征，具有被广泛应用于火焰燃烧状态检测领域的潜力。同时，深度学习是近年在人工智能领域的重大突破，通过建立多隐藏层的神经网络，自动学习得到最优特征，在数据特征提取和图像识别等方面具有很大优势。因此，将深度学习等人工智能算法结合数字图像处理技术应用于炉膛燃烧状态监测已经成为众多学者关注的热点。现有的火焰图像监测技术主要是将数字图像处理技术与人工智能算法结合，通过传统特征提取技术或者深度学习方法提取火焰图像的特征并利用其建立基于数据驱动模型来监测锅炉燃烧过程，并根据特征参数结合机器学习算法判断炉膛内部煤粉燃烧稳定性状况。
** 国内外研究动态
炉膛火焰燃烧时会释放出大量的福射能量，这包括有：光、热和福射能等，同时锅炉内也会伴有复杂的能量转化和表征火焰燃烧的特征信息，如火焰燃烧发出的声音和炉膛负压变化等信息。而火焰传感器检测火焰的原理就是通过检测这些特征量的存在来作为燃烧判据。传统锅炉火焰检测技术按照检测的方式分为非接触式与接触式和两类。
1. 接触式火焰检测
接触式火焰检测是利用检测传感器来直接测量锅炉火焰的福射热能或其它特征量的方法。常用的接触式火焰检测包括有：烟色法、电极检测法、压差法、声学法、温度检测法等[5]。接触式火焰检测要把检测装置安装于炉内，通常安装位置相对固定，且检测位置要求高[6]，但是锅炉内部环境复杂恶劣，伴随着高温、高压还有各种飞灰和腐蚀性气体等，这些都对检测装置可靠性提出了更高的要求。
接触式火焰检测由于其在实际应用中存在的较大局限性，在现代锅炉火焰检测系统中已经被淘汰，其局限性主要表现在[7,8]：功能单一，误差大，可靠性低，安装调试困难。
2. 非接触式火焰检测
非接触式火焰检测是一般意义上的火检，通过检测各辐射能信号来进行火焰的灭火检测，由于是一种非接触检测方法，检测的可靠性较接触式提高，因此在锅炉火焰检测方面得到广泛应用。根据福射光能的光谱波段的不同非接触式火焰检测器可分为：红外型火检器、可见光型火检器、紫外型火检器以及组合型火检器[9]。
非接触式火焰检测与被测介质没有直接接触，和接触式火焰检测相比避免了炉膛高温复杂环境使用限制，也无需等到检测参量的动态平衡，检测的响应速度快精度更高，可适应不同燃料和工况下的火焰检测，因此相比接触式火焰检测具有更好的实用性，但同时也存在很多问题[10]：火焰检测器易损坏，检测的可靠性不高；火检器检测器参数设定与火焰随负荷动态燃烧的矛盾；火焰检测探头视角小与火焰脉动飘移的矛盾；火检器功能单一与燃烧诊断的矛盾。
传统的锅炉火焰检测技术由于其在应用中的局限性，无法满足工业锅炉燃烧工况要求已经被淘汰，随着工业和计算机技术的不断发展，工业锅炉的可视化和智能化监控系统受到越来越多研究者的关注。研究者为了获取炉内燃烧状况的更多有效信息而做了大量的工作，并在当前的科技发展水平上，提出了许多新技术、新方法。
随着火检技术的不断发展，当前电站锅炉火焰检测内容己经由最初的检测火焰的有无增加了各种诊断内容。针对锅炉燃烧稳定性的判定问题，国内外研究现状主要分为以下几类方法：
*** 基于火焰辐射强度的燃烧判稳方法
辐射是燃烧过程的特点之一，对于工业燃烧火焰，目前有越来越多的研究人员利用火焰辐射的探测来进行燃烧诊断的研究，以掌握实际燃烧设备的燃烧状况，为充分利用能源、减轻环境污染、提高燃烧过程的安全性提供有效的监测手段，对现代大型电站锅炉而言，火焰监测是同装置运行的安全性和经济性紧密联系在一起的，且对火焰监测技术水平的要求愈来愈高[11]。
燃烧火焰是表征燃烧状态稳定与否最直接的反映，而煤粉火焰辐射光的一个重要特点就是火焰脉动，它是随时间变化的[12]，基于这个特点，马骏等人[13]通过光电传感器获得一系列以一定的频率、在某个均值左右上下波动的火焰强度值，利用快速傅立叶变换算法（FFT）的处理将获得的时域信号转换成频域上的功率信号，又因为在稳定和不稳定的燃烧状态下转换后得到的低频分量有明显的区别，所以把每个功率谱中前30个低频分量取出作为神经网络的训练输入。然后通过自组织神经网络的学习训练，得到对应于稳定和不稳定燃烧状态火焰信号的不同输出区域，从而对火焰在稳定燃烧工况、不稳定燃烧工况和不定燃烧工况进行有效的模式识别，最终给出燃烧诊断的判断结果。
由于可见光波动强度较小，频谱范围较窄，利用单燃烧器检测可见光信号比依靠红外线和紫外线检测可取得更大的视野范围，获得更多的信息量[14]，从而有利于提高判断的灵敏度和准确性。敖丽敏等人[15]基于煤粉燃烧的火焰脉动的特点，通过采集单燃烧器的光强信号，借助小波在非平稳信号处理中的时频局部化及其特有的优良特性[16]，进行信号的特征提取和小波降噪，把含噪信号进行多尺度的小波分解、特征提取，对信号进行软阈值去噪处理，去除白噪声和有色噪声的干扰，将预处理后的信息作为神经网络的训练输入建立子空间能量和燃烧状况之间的映射关系。
*** 基于炉膛微压信号的燃烧判稳方法
微压探测是目前锅炉燃烧诊断的重要手段之一。其理论基础建立于燃烧有关振动研究的基础之上。通过对燃烧中产生微压波动的检测对燃烧状态进行判断，从而获得微压波动能谱与燃烧状况的相应关系。基于炉膛微压信号的燃烧诊断具有处理数据量少、测点安装和调试简单以及硬件成本低等特点，可以对火焰图像处理方法进行辅助判断，但由于锅 炉燃烧过程十分复杂，有些机理还不十分清楚，相应的微压特性也很复杂，高翔等人[17-19]对此做过一些初步研究与探讨，他们的工作主要是在试验炉上。
肖隽等人[20]通过对江苏某电厂现场运行锅炉进行试验，对测得的数据进行频谱分析，获得了炉膛负压信号变化与燃烧状况之间的重要关系：炉膛压力变化的确反应了锅炉燃烧状况，与不同燃烧状况相对应的炉膛压力具有一定的频谱特征；锅炉点火与熄火属于不稳定燃烧状况，此时炉膛负压信号频谱中有冲击信号特征，这是由于锅炉启停过程中炉膛压力信号有一个升高或降低的阶跃变化，正是这种阶跃导致压力信号频谱中的低频冲击；锅炉冷态工况、锅炉满负荷以及锅炉低负荷燃烧工况都属于稳定燃烧工况，稳定燃烧工况炉膛压力信号频谱具有明显的特征频率，相互之间可以区分。
高翔等人[21]利用压力传感器进行了燃烧状态诊断的试验研究，提出了一种通过压力脉动信号分析燃烧状态的简单有效方法，对归一化后压力脉动信号作线性回归并计算回归直线斜率K，根据K值对燃烧状态进行分类判断。高翔等人提出随K值的增大燃烧状态趋于不稳定，对于本实验炉当| K | > 0.6时为燃烧状态处于的熄火和点火剧变过程，而| K |∈[0.3, 0.6)则燃烧处于不稳定状态，只有| K | < 0.15时燃烧状态才基本稳定，通过频谱分析发现，当频带具有3Hz以下的低频能量富集区时该燃烧状态不稳定。
*** 基于光谱信息的燃烧判稳方法
燃烧火焰的辐射光具有很宽的连续光谱。煤粉的燃烧过程可以简单的看作是化学中的氧化过程，这一过程主要发生在炉膛的主燃区，燃烧反应的过程并不是在极短的时间内完成的，在燃烧区域内不可避免的存在大量未充分燃烧的中间产物。其浓度直接影响了火焰光谱的特征波长，因此根据火焰的光谱分析作为煤粉燃烧的重要依据成为可能，这就是光谱分析火焰稳定性的基础。
煤粉燃烧过程中强度和脉动是两个重要的过程值。这两个值直观的反映了燃烧火焰的特征。不同的煤粉浓度下，火焰的光谱分布曲线（光强-波长曲线）不同。在波长为5000埃和7000埃附近出现峰值，在6000~7000埃之间出现低谷，并且在低估段内火焰辐射强度随火焰中煤粉浓度的降低而减少，呈明显的正相关性，而两个峰值段却无此现象[22]。Shimoda[23]通过定性分析指出，燃烧火焰检测的辐射波长应该在6000~7000埃之间进行，当波长小于5500埃时燃烧火焰的信噪比很小，而当燃烧火焰的波长大于7000埃时，周围热环境的辐射信号很强，检测信号不能正确的反应燃烧工况的变化。
蔡小舒等人[24]基于煤粉火焰辐射光谱信号，发现在煤粉锅炉中不仅不同火焰及炉墙的黑度不同，在煤粉不同燃烧阶段还存在一些特征谱线，根据是否存在这些特征谱线，以及测得的火焰黑度和火焰的光谱辐射强度可以可靠地构造火焰是否存在的判据。在此基础上蔡小舒等人提出了一种煤粉火焰燃烧监测和诊断测量方法，即测量煤粉火焰的从可见光到近红外的辐射光谱，分析光谱特性来得到火焰温度和黑度，以及美分燃烧的特征辐射谱线，根据普朗克定律和维恩公式中火焰辐射光谱与火焰温度与黑度的相对关系，构造了火焰复合判据作为燃烧判稳的特征参数，以判断火焰是否存，并根据测得的火焰黑度和辐射强度用人工神经网络对煤粉火焰的燃烧状况进行诊断。
*** 基于火焰图像的燃烧判稳方法
随着计算机视觉的快速发展，应用人工智能、深度学习等新的理论结合数字图像处理技术成为众多学者关注的热点。它继承了火焰电视直观、形象的优点，又充分发挥计算机强大的计算处理能力，使火焰检测功能得到了质的提升。由于火焰的复杂动态特性，现阶段，基于火焰成像技术的燃烧监测主要是将图像处理技术与软计算技术相结合，提取火焰图像特征并利用建立数据模型的方法来对其状态进行监测。
上世纪80年代开始采用火焰福射图像处理技术进行燃烧检测和诊断的研究，最早是日立公司开发了火焰图像识别系统FIRES（Flame Image Recognition System），该系统亦被用来进行NOx诊断[25]。三菱的光学图像火焰扫描OPTIS（Optical Image Flame Scanner）系统对火焰探测的灵敏度有一个很大的提高，能够减少来自炉膛背景热辐射及邻近锅炉对待检测火焰信号的干扰[26]。Takamura Shozo等人[27]在垃圾焚烧炉出口安装TV摄像机得到燃烧火焰图像，从中提取燃烧参数进行燃焼控制，并且搭建基于Kohoen神经网络的模型，该模型能进行自组织学习，并将图像像素值转化为进行燃烧诊断的定量指标。K.Sijatha等人[28]研究了使用分类算法的用于对电站锅炉燃烧质量评估的火焰图像分析。
在国内，清华大学吴占松教授[29]最先开始对火焰图像进行处理研究，其最早的研究是测量火焰温度分布。上海交通大学的徐伟勇教授等人[30]利用CCD摄像机获取燃烧图像，伪彩显示燃烧图像，并综合伪彩火焰特征与燃烧器的开关状态来对燃煤锅炉进行燃烧稳定性判定。华中科技大学的周怀春教授[31,32]带领的团队一直在进行炉膛温度场重建的理论和工程应用研究，目前已取得一定的成果。东南大学王式民教授等人[33]研究了火焰三维温度场可视化的方法，该方法亦是对火焰图像的处理研究。华北电力大学刘禾教授等人[34]提出了新的特征参数——差分图像相对变化量进行燃烧判稳。
由于炉膛火焰燃烧过程的复杂性，使得准确反映炉膛火焰燃烧状态的火焰图像特征参数难以确定，在用神经网络训练方法构造分类器时，神经网络的收敛速度和识别的准确性不能同时满足实际要求。韩璞等人[35]提出了交互式火焰图像识别方法：将人对识别结果的评价信息加入火焰图像的分类识别系统中，以此改善神经网络的分类识别性能。韩璞等人提出的交互式火焰图像识别系统，在构造神经网络的过程中，引入用户反馈信息来修正神经网络分类器，这样既可以有效降低模型对火焰特征参数的依赖性，加速收敛，又可以实现隐含层神经元个数的动态调整，提高系统的识别准确性。
刘禾等人[36]研究了关于燃煤锅炉的燃烧稳定性判别问题，在动态图像上提取了燃烧稳定性特征参数，即提取图像中着火位置相对变化量作为描述火焰燃烧动态变化过程，利用模糊神经网络进行燃烧稳定性判断，故障诊断模块是采用了由3层BP神经网络建立的诊断模型，将燃烧状态判别为稳定、较稳定、欠稳定和不稳定4种状态。该方法利用模糊神经网络获取专家判别经验，并可通过网络学习调整判别规则以适应各种燃烧状况，该判别方法有效地实现了燃烧稳定性判断，对实现炉内燃烧状态监测、保障锅炉设备安全运行具有重要意义。
徐宝昌等人[37]针对锅炉燃烧监控系统所采集的火焰动态图像，提出了一种基于在线模糊聚类算法的炉内火焰燃烧诊断方法。该方法分析了火焰图像的特点，提取了判别火焰稳定性的特征量，以提取的特征量作为在线模糊聚类算法的输入参数，分析燃烧图像的隶属度，给出判别标准对燃烧稳定性进行综合评估，但判别标准的可行性还有待进一步验证。
Liu等人[38]提出了一种支持向量机（SVM）算法来监测炉膛火焰的状态。根据数字图像处理技术提取火焰特征量构成一组向量，然后使用支持向量机分类算法对燃烧火焰进行分类。利用该方法对火焰图像进行分析，可以有效地确定燃烧状态的燃烧状态。
吴一全等人[39]将Krawtchouk矩引入火焰特征提取，将Krawtchouk矩不变量与小波支持向量机相结合的火焰燃烧状态识别方法。采用支持向量机算法对火焰图像进行状态识别；并采用混沌小生境粒子群算法优化支持向量机中的核函数与惩罚银子，使识别性能达到最优。
Li等人[40]利用图像处理技术提取图像特征，采用极限学习机（Extreme learning machine，ELM）判断燃烧状态。其均采用图像分割技术对火焰图像进行分割，随后提取火焰特征，建立极限学习机模型，对回转窑内火焰的状态进行识别。
Wang[41]提出了一种新的基于深度学习的方法来识别炉膛燃烧状态和测量放热率。通过端到端网络，特征提取和燃烧状态分类被集成到一个框架中。深度学习模型将火焰图像转化为多层DNN（深度神经网络）或CNN（卷积神经网络），以同时预测燃烧状态和热释放速率。
*** 基于统计学方法的燃烧判稳方法
火焰的形状在不同的燃烧状态下是随机波动的，但在一定燃烧条件下，一些火焰形状参数是具有一定统计规律的，所以通过使用这些参数可以用于对火焰稳定性进行描述。
Qiu[42]介绍了在二维火焰图像中高效提取中轴的水平切割中轴（HCMA）算法，这种方法使用边缘检测算法得出火焰的边缘，再对火焰边缘图像计算中轴。随后，Qiu[43]又提出了三维空间中提取火焰中轴的算法。在三维空间中分别从两个相互垂直的角度去获取火焰图像。三维中轴描述起来更复杂，二维是用内切圆的圆心去定义中点，三维则是内切球体的球心去定义，然后获得中轴。
基于统计学分析方法，提取火焰燃烧中的特征。其中一种源于图像处理的统计学方法中轴统计分析法具有反映不同燃烧状态的能力。Sun[44]证明了中轴对于火焰形状的描述是有用的，它可以大大减少数据处理的数据量。
白卫东等人[45]采用CCD成像系统采集火焰信号，提取火焰的燃烧区域、着火点等火焰特征信息，然后基于主元分析技术提出一种对燃烧火焰的稳定性进行监视和诊断的方法，采用Hotelling T_2和平方预测误差（Squared prediction error，SPE）两个统计量对每一时刻的图像数据向量进行监测，检验是否超过各自的控制限，只要这两个统计量之一越限，则可判定燃烧出现异常。
Chen[46]提出了一种新颖的视频在线火焰检测方法。该方法包括隐马尔可夫模型(HMM)和多路主成分分析(MPCA)：利用MPCA在低维空间中提取空间关系之间的相互关系，并构造序列观测的时间行为。虽然在操作过程中可能无法获得先前的过程知识，但正常状态的概率分布可以通过从正常操作过程中收集到的图像进行训练；通过递归维特比算法对新观测到的图像进行监测，从观测到的序列中找到过渡状态序列。与传统的统计过程控制原理一样，生成简单的概率监控图来跟踪当前过渡状态序列的进展情况，并监控可观测到的扰动的发生情况，旨在早期检测燃烧系统状态，防止系统进一步退化和出现故障。
针对传统基于成像技术的燃烧过程监测方法仅适用于单个燃烧工况的问题，Bai[47]结合数字成像，提出了一种基于PCA-RWN（主成分分析和随机加权网络）的多工况燃烧过程监测方法。基于PCA-RWN的多工况燃烧监测方法可以有效的识别不同的一次风量工况并且多元统计量T2和SPE可以有效检出异常燃烧状态。
** 论文内容安排
近年来由于国家对于环保、电源结构调整做出的策略，火力发电在总发电量中占比降低，但受到能源结构、历史电力发电布局等因素的影响，在未来很长的一段时间内，国内仍将是以火力发电为主力军。火力发电机组中的一个重要组成部分就是锅炉，锅炉内的燃烧状态关系到整个机组运行的安全性和经济性，因此在煤粉燃烧时需要对其进行实时监测，并根据现场采集的数据对燃烧的稳定性做实时在线分析。传统的火焰检测器由于存在各种原因己无法满足目前火力发电厂的需求，其需要更有效的检测器对锅炉燃烧状态进行监测。本文通过对采集到的火焰视频进行分析，提取能够反映锅炉燃烧状态的火焰特征量，并在连续时域上提取特征量的连续序列，对锅炉燃烧稳定性进行判别，本文的研究内容分为以下六个部分：
第1章为绪论，说明了燃煤机组炉膛燃烧稳定性研究的背景与意义，并就燃烧火焰监测技术的发展做了概述，介绍了几十年来国内外专家学者对于燃烧火焰稳定性判别所提出的各种方法及研究成果，进一步说明了火焰图像的重要性与深度学习在此方面应用的良好前景，最后概述了本文的主要研究内容。
第2章简述了煤粉进入锅炉后的燃烧过程，介绍了炉内煤粉气流的着火特性以及影响煤粉气流着火的因素。其次，简要介绍了燃烧调整实验的实验设备和测试条件，并简述了燃烧调整实验的大致过程及对应给煤量变化趋势。最后，选取图像采集装置所采集的火焰视频中不同燃烧状态的火焰图像作为实验数据，并介绍了本文对火焰图像进行预处理的主要流程。
第3章主要介绍了变分自编码与卷积网络的原理与特性，包括其在图像处理领域的优势以及大致应用过程，因二者具有强大的特征提取能力本文将其结合应用至燃煤机组的火焰图像中，搭建了基于变分自编器的火焰图像特征提取模型，并通过对网络结构及参数的调试与修改，实现了有效、可靠的图像潜在特征提取，并通过与给煤量变化趋势、其他特征提取方法进行对比分析进一步说明了卷积变分自编码的卓越性能。
第4章简要介绍了主成分分析法和k-means聚类算法的基本原理、主要流程和优势特点，在第二章的基础上搭建了基于卷积变分自编码器和k-means算法的无监督聚类框架。将第三章中无监督特征提取的特征向量经过主成分降维，进一步确保特征向量中各分量相互独立，然后输入到k-means算法模型中进行聚类分析，以实现对炉膛煤粉燃烧状态的评估；其次，对以上基础的实验结果进一步讨论分析，利用正则化思想对聚类结果进行量化，以实现对煤粉燃烧状态进行定量表征。
第5章简要介绍了长短时记忆网络与MultiRocket时间序列分类方法的基本原理，为了更充分地利用图像采集装置所采集的火焰视频中的时间信息，将第三章中无监督特征提取的特征向量封装为时间序列，输入到了长短时记忆网络、Rocket与MultiRocket时间序列分类网络中进行实验分析，实验在训练集和测试集上均表现出良好精度，MultiRocket在时间成本花费上的效果良好，更好地描述了炉膛煤粉燃烧状态，提高火焰燃烧状态监测的准确性、可靠性和全面性。
第6章为本文的结论，总结了燃烧火焰状态监测技术的研究，梳理了本文的成果和工作。
* 煤粉燃烧调整实验与数据预处理
** 煤粉燃烧过程
燃煤锅炉的发电过程是通过磨煤机将煤粉细化，再经过送风机吹出的一次风气流送入炉膛，并在炉内沿一定方向移动，从煤粉进入到煤粉加热燃烧将经历一个复杂的过程，这个过程包括挥发物释放、焦炭燃烧、辐射传热等。在炉内对流和辐射传热的作用下，煤粉颗粒的温度最终达到着火点。
1. 炉内煤粉气流的着火特性
   
   一次风与煤粉混合气流射入炉膛后，与炉膛内的火焰热流相接触，接触后混合气流从火焰热流中吸收热量，其中混合气流吸收热量的方式也可以看成是热流在炉膛内传播热量的方式，热流在炉内传热的方式主要为对流和辐射传热，当混合气流吸收足够热量达到着火点后开始燃烧。热流在炉内热量的传播并非同时包含这两种方式，当火焰锋面处于静止的状态时，热流的传播
   煤粉的着火过程主要由两部分组成：混合气流进入炉膛后直接通过辐射传热吸热，由于煤粉无法吸收所有的热量，而混合气流的燃烧，不但要求煤粉达到着火点，同时气体也需要达到着火点，因此剩余的部分通过对流传热被气体所吸收，再通过气体传递给煤粉，由于气固两相流之间的差别，气体和煤粉之间的热量传递比较困难，存在着较大的热阻。
2. 影响煤粉气流着火的因素
   1) 煤质。挥发分在不同的煤种中所占的比分是不同的，这些挥发分会对混合气流的燃烧产生影响。如果煤质中所含的挥发分越低，那么混合气流要达到着火温度需要从炉内吸收的热量也就越多。挥发分越高，混合气流需要达到着火温度吸收的热量就越少。

   2) 一次风影响。一次风风量的大小和风速的快慢都会对煤粉的燃烧造成影响，其主要影响煤粉燃烧时的着火位置。由于煤粉燃烧初始阶段所需的氧气都是由一次风提供，因此一次风风量应尽可能保持适中。同样，如果风速太高，一次风与煤粉混合气流在炉膛中的长度会增加，这将影响煤粉的正常燃烧。如果风速太低，则煤粉的着火位置将太靠近燃烧器并导致锅炉设备损坏。

   3) 燃烧器特性的影响。不同燃烧器的特性，以及这些燃烧器所放置的位置等因素都会影响混合气流的燃烧。
** 现场实验测量装置
本文选用了吉林省某火电厂660MW 机组作为实验设备。如图2-1为该电厂锅炉燃烧器分布情况图，该锅炉为前后墙对冲燃烧方式，前墙依次分布为C、D、E、F 层燃烧器，后墙依次分布为A、B、G层燃烧器。各层燃烧器分别配有中速磨煤机，磨煤机的煤粉管道与相应各层燃烧器连接。
#+Caption: 锅炉燃烧器分布情况
[[./img/paper/2_burner.png]]

火焰图像监测装置安装在F层燃烧器对应的观火孔位置上，如图2-2所示为锅炉F层燃烧器的外部结构图，在F层燃烧器上开孔并伸入火焰图像探头，接入冷却风管道对其进行冷却以保证其探头温度不超过70℃，防止老化或烧损。
#+Caption: 火焰监测装置现场安装位置
[[./img/paper/2_ccd_loca.png]]

相机的感光元件采用的是 1/4 英寸的 CCD 图像传感器，如图2-3所示，火焰燃烧产生光幅射，透过CCD摄像机的镜头，经过一系列的处理过程，光信号被转换成电信号，红、绿、蓝三种基本颜色信号经过上述处理转换后就会带有亮度的信息。数字硬盘录像机对模拟图像信息进行模/数转换以及对数字信息进行存储，在不同的方面对图像进行离散化处理，将原来的不能被计算机直接处理的模拟图像信号转换成可以用计算机根据已编程序进行处理的数字型信号，以便进行下一步更深层次的处理。视频图像每秒显示25帧图像，每帧图像分辨率为960×576，三通道分别为红、绿、蓝（RGB）。
#+Caption: 图像监测装置工作原理图
[[./img/paper/2_ccd_pr.png]]

** 燃烧调整实验
为了研究煤粉燃烧火焰稳定性，在某660MW机组的前后墙对冲锅炉F层燃烧器进行了燃烧调整实验，采集了实验前后三个小时（2018年9月9日13:00至16:00）的不同燃烧状态下的火焰图像和给煤量数据。燃烧稳定性实验在该日14:35分左右进行，具体实验过程为在正常炉膛火焰稳定燃烧工况下，炉膛火焰燃烧状态稳定，通过逐步减少给煤量至0，使得炉膛燃烧火焰由稳定变为不稳定，直至灭火，经过一段时间后，再重新开启燃烧器，缓慢增加给煤量，至该层燃烧器由点火状态重新回到稳定的燃烧状态。从图2-4中可以看出在13:00:00-14:35:00期间给煤率稳定在 [58 t/h, 72 t/h] 区间内 ，而从14:35:00开始逐渐减小给煤率，14:37:45给煤率降低到30 t/h，之后一直保持该给煤率直到14:45:15给煤率降为0 t/h，期间保持熄火状态；15:02:00时开始逐渐增加，15:17:35给煤率开始大于58 t/h，并且在之后给煤率保持稳定在 [56 t/h, 70 t/h] 区间内，表示此后燃烧状态达到稳定。
#+Caption: 给煤量变化图
[[./img/paper/2_coal.png]]

# QT: 建议补充燃烧稳定、不稳定和灭火时的火焰图像，并对图像进行简单描述，目的是说明火焰图像能够反映燃烧的不同状态。
** 火焰图像预处理
本文选取电厂燃烧调整实验中稳定时段、变负荷、给煤量波动较大时段所收集三个小时的视频中的火焰图像作为实验数据，首先进行如下步骤的预处理：
1. 将所采集的火焰视频逐帧截取，得到每秒25帧的火焰图像，为消除闪烁对相机成像的影响，获得高质量代表性图像，对图像进行平滑处理，即利用像素平均法对每秒得到的25帧图片取平均，以代表该时间段内的火焰燃烧状态。
2. 为了减少冗余的细节干扰，按照逆时针方向围绕观察孔形状选点设定模板，将模板应用于经过上述处理的原始图像，对火焰图像进行裁剪，最外层多边形在进行黑色填充，仅保留CCD相机透过观察孔所收集图像中的火焰燃烧部分。
3. 经过上述步骤得到的图片分辨率为960×576×3的RGB图像，为了更加符合深度学习结构特性提升训练效率，通过双线性方法将图像压缩至大小为128×128×3的长宽相等的正方形图片。
   
图像预处理具体流程如图2-5所示：
#+Caption: 图像预处理流程
[[./img/paper/2_img_pretre.png]]

** 本章小结
本章简述了煤粉进入锅炉后的燃烧过程，介绍了炉内煤粉气流的着火特性以及影响煤粉气流着火的因素。其次，说明了燃烧调整实验的实验设备和测试条件，以及燃烧调整实验的具体过程和给煤量的变化趋势。最后说明了对所获取的火焰图像进行的预处理流程。

* 基于卷积变分自编码的火焰图像特征提取
变分自编码器作为一种生成模型，由于具有采样速度快、准确对潜在结构进行建模、训练稳定和编码网络易于接入[48]等优点，而且可以与其他很多神经网络模型进行较好地结合应用，因此，已经广泛用于各类计算机视觉任务中，如图像合成、图像显著性检测和运动预测等。
本章将采用变分自编码算法，并借助卷积神经网络的强大高维数据处理能力，给定无标签数据，以非监督学习的形式，更准确、有效、稳定地学习特征，保留有用信息。利用神经网络的方法自动提取潜在的变量，从而减轻了工作人员的负担。
** 变分自编码器基本原理
变分自编码器[49]（Variational AutoEncoder，VAE）是一种生成模型，其关键思想是对可能生成数据X 、符合高斯分布p_0(z)~N(0,I) 的隐变量Z进行采样，并从中计算概率分布模型P( X) 。对于图像生成任务，给定数据集 \(X = {x^{(i)}_{i=1}^{N}\)，VAE能够学习图像特征的概率分布。为此，VAE训练一个参数化的概率分布模型 \(p_{\Theta}(X)\) 以近似数据分布，也即识别模型，并用最大化对数似然来优化模型。如公式3-1所示。
\[logp_{\theta}(X) = logp_{\theta}\big(\chi^{(1)},\chi^{(2)},...,\chi^{(N)}\big) = \sum_{i=1}^{N}logp_{\theta}\big(\chi^{(i)}\big)\]
但X是高维数据，其结构化图模型的潜变量之间相互作用导致 \(p_{\theta}(X)\) 求解困难，因此无法估计边缘似然、无法使用EM等算法[49]。故VAE引入低维隐变量 Z ，构造更易求解的近似推断模型 \(q_{varphi}(Z|X)\)，也即生产模型，采用最大化似然对 \(q_{varphi}(Z|X)\) 进行有效优化。单个样本的最大似然如公式3-2所示。
\[logp_{\theta}\big(\chi^{(i)}\big) = L\big(\varphi,\theta,\chi^{(i)}\big)+D_{KL}\Big(q_{\varphi}\big(z|\chi^{(i)}\big)\Big)||p_{\theta}\big(z|x^{(i)}\big)\]
因 \(D_{KL}\Big(q_{\varphi}\big(z|\chi^{(i)}\big)\Big) \geq\ 0\)，则有：
\[logp_{\theta}\big(\chi^{(i)} \geq\ L\big(\varphi,\theta,\chi^{(i)}\big)\]
\[L\big(\varphi,\theta,\chi^{(i)}\big) = E_{q_{\varphi}\big(z|\chi^{(i)}\big)}-D_{KL}\Big(q_{\varphi}(z)\Big)\]
其中，D_{KL}\Big(q_{\varphi}(z)\Big) 为q_{\varphi}\big(z|\chi^{(i)}\big)} 与\(p_{\thela}(z)\) 间的KL散度；L\big(\varphi,\theta,\chi^{(i)}\big) 为 \(x^{(i)}\) 的变分下界。由公式（3-4）可知，VAE将求解 \(p_{thela}(X)\) 转换成优化 \(L\big(\varphi,\theta,\chi^{(i)}\big)\) 最大值，相当于最小化KL散度。如图 3-1 所示。
#+Caption: VAE 变分下界与 KL 散度的关系
[[./img/paper/3_vae_kl.png]]

VAE模型训练的损失函数分为两部分：最小化生成图片与输入图片之间的重构损失（即似然期望最大化）以及最小化识别模型概率分布与潜在变量 𝑧 的概率分布之间的散度。VAE本质上也是一个生成潜变量模型，结构上也分为编码器和解码器两部分，具有很好的扩展性，可以和其他的很多神经网络结合应用。其大体思想是把原始数据通过编码器映射为一个理想的高斯分布，再将高斯分布采样的样本输入进解码器，重建原始数据。如果重建数据与原始数据十分相似，就说明学到了一个AE模型，VAE就是在自编码器的基础上加入了变分处理，使得编码器的输出能够对应到目标分布的均值和方差。VAE网络结构如图3-2所示。
#+Caption: VAE 网络结构示意图
[[./img/paper/3_vae.png]]

** 卷积神经网络基本原理
卷积神经网络[50]（Convolutional Neural Networks，CNN）是一种特殊的人工神经网络，它的设计受到了生物神经元的启发，其中卷积核模仿了生物视觉的中的“局部感受野”，卷积层的叠加结构模仿了视觉系统的层次性。深度学习端到端地学习特征，无需人工提取特征，它能够学习到更适合该任务的表征形式。因此，深度学习实际上是表征学习的一种形式。卷积神经网络是众多深度学习模型中的一种，特别是在图像处理方面，卷积神经网络凭借其强大的特征提取能力而被广泛应用。相比于传统的图像方法，使用卷积神经网络进行图像处理方面最大的优势在于它在训练中可以自主地完成对特征的学习，而不需要再人为的设计特征，在数量多、分辨率高的图像处理领域表现尤为突出。因此，卷积神经网络已经成为特征提取、图像分类、目标检测等领域广泛使用的结构之一。
卷积神经网络实际上是一个层次模型，原始数据逐层通过网络的卷积层、池化层、激活层、全连接层等，逐步提取低级特征，直至高级语义特征，其结构如图3-3所示。
#+Caption: CNN网络结构示意图
[[./img/paper/3_cnn.png]]

1. 卷积层
   卷积操作的主要思想是通过对输入数据使用卷积核，也称为滤波器，卷积核可以是任何大小，通常小于输入数据，在输入数据上滑动卷积核以识别特征。其典型过程是输入数据与卷积核进行卷积操作，即卷积核在输入数据上滑动，计算与输入数据重叠部分的点积或矩阵乘积合。根据不同卷积核参数的值，能够提取和识别输入数据中的不同模式和特征。
2. 池化层
   池化操作在卷积运算的输出的不同位置的信息整合操作，通过对数据区域进一步聚合精简，在减小输出大小的同时仍能突出关键特征征。池化操作的使用有助于提取特征的不同组合，这些特征对于平移和局部微小的扰动是不变的。将特征图的大小减小到不变的特征集合上不仅可以降低网络的复杂性，而且可以通过减少过拟合来帮助提高通泛化性。
3. 全连接层
   全连接层是线性特征映射的过程，将学习到的分布式特征表示映射到样本标记空间，可以看作是对特征的加权操作，大部分卷积神经网络采用三层全连接层作为分类器，包括输入层、隐含层和输出层，每层的神经元与上一层所有神经元全部连接。与池化和卷积不同，全连层是全局操作，对输入特征张量进行全局操作，从而帮助卷积神经网络对所有输入信号做出一个全局的特征提取。
** 基于卷积变分自编码的火焰图像特征提取网络模型
基于变分自编码器采样速度快、对潜在结构进行准确建模、训练稳定和易与其他神经网络模型结合应用，以及卷积神经网络强大的特征提取能力、且有较少数量的网络参数、较低的模型复杂性，本文采用了基于卷积变分自编码的火焰图像特征提取网络模型，以完成对炉膛煤粉燃烧的火焰图像进行特征表征。
图3-4显示了 VAE-CNN 模型的网络结构，其中编码网络由四层卷积层、四层最大池化层以及一层全连接层构成。其中，所有的连接层都采用3 × 3卷积核，卷积层后跟着ReLU激活函数和步长为2的最大池化层，将第四池化层输出展为一维向量。解码过程与编码过程完全对称。另外，在解码网络最后一层中应用 Sigmoid 非线性激活函数来产生输出 𝑦。模型选用交叉损失熵函数作为衡量输入原始图像 𝑥 与输出 𝑦 之间的差异。训练目标为输入的火焰图像与输出的火焰图像越接近越好。模型误差由两部分组成，分别是：识别模型中潜在变量 𝑧 的概率分布与高斯分布之间的KL散度以及重构图像与输入图像之间的重构损失（这里选择交叉熵来衡量其差异）。
#+Caption: VAE模型网络结构图
[[./img/paper/3_vae_cnn.png]]

图像重构之后，输出的图像通常都会在一定程度与原始图像存在差别。为了更好验证和对比本文所使用的方法的可靠性，通常以均方误差[51]（Mean Square Error，MSE）、峰值信噪比[51]（Peak Signal to Noise Ratio，PSNR）、结构相似度[52]（Structural Similarity index，SSIM）、多尺度结构相似度[53]（Multi-Scale Structural Similarity index，MS-SSIM）4种图像质量评价指标作为参考和衡量标准，如表3-1所示：
#+Caption: 图像质量常用评价指标
| 简称  | MSE                 | PSNR     | SSIM     | MS-SSIM  |
| 值域  | [0,1]               | [0,100]  | [0,1]    | [0,1]    |
| 评价  | 数值越低，图像质量越高 | 数值越高，图像质量越高            |

 1) MSE和PSNR
    MSE 和 PSNR 均是以统计方法、从全局角度衡量两张图像的区别，逐像素计算增强图像和参考图像像素间的差异。MSE 值越小、PSNR 越高，增强图像与参考图像越接近。MSE、PSNR 可由公式3-1、3-2计算，其中 H, W 表示图像尺寸（高和宽），i, j 为图像像素的下标，X, Y 表示增强图像和参考图像，n 为表示每个像素的二进制位数，通常设置为 8。
    \[mse = 1/{HW} {X(i,j)-Y(i,j)}^{2}\]
    \[PSNR = 10log_{10}{{{2^{n}-1}}^{2}}/{MSE}\]
2) 基于图像结构信息退化和人类视觉感知的特性，Wang[52]等人提出了SSIM，SSIM从三个方面衡量增强图像和参考图像间的距离：对比度、亮度和结构。SSIM取值范围为[0,1]，随着 SSIM值增大两张图像越接近，即增强图像质量越高。基于SSIM，Wang[53]等人提出了MS-SSIM，将图像宽高以 \(2^{M-1}\) 为因子进行缩放，再计算SSIM。SSIM和MS-SSIM可由公式3-3至3-6计算，其中X, Y表示生成图像和参考图像，\(\mu_{X}, \mu_{Y}\) 为图像X, Y的像素均值，\(\sigma_{X}, \sigma_{Y}\) 为图像X,Y的像素方差，\(\sigma_{XY}\) 为图像 X,Y 的协方差，\(c_{1}, c_{2}, c_{3}\) 为常数。
   \[L(X,Y) = {2\mu_{X}\mu_{Y} + c_{1}}/{\mu_{X}^{2} + \mu_{Y}^{2} + c_{1}}\]
   \[C(X,Y) = {2\sigma_{X}\sigma_{Y} + c_{2}}/{\sigma_{X}^{2} + \sigma_{Y}^{2} + c_{2}}\]
   \[S(X,Y) = {\sigma_{XY} + c_{3}}/{\sigma_{X}\sigma_{Y} + c_{3}}\]
   \[SSIM(X,Y) = L(X,Y)^{\alpha}·C(X,Y)^{\beta}·S(X,Y)^{\gamma}\]
   其中，\(\alpha=\beta=\gamma=1\），L(X,Y)是亮度比较，C(X,Y)是对比度比较，S(X,Y)是结构比较。
   \[MS-SSIM(X,Y) = {{SSIM_{j}(X,Y)}^{-K_{j}}},  K_{j} = 1\]
** 实验结果及分析
本文选取电厂燃烧调整实验中稳定时段、变负荷、给煤量波动较大时段所收集三个小时的视频中的火焰图像作为实验数据，经过第二章所述图像预处理后，得到三小时共10800张128×128×3火焰图像照片作为训练数据，输入卷积变分自编码器中，训练得到特征提取的模型。
算法开发与运行的环境如下：
1. 系统平台：Windows10 PC
2. 硬件环境：
   (a) CPU: Intel Core i7-8750H 2.20GHz 16G
   (b) GPU: NVIDIA GeForce GTX 1050 Ti
3. 开发工具：JetBrains PyCharm 2019.1.1
4. 开发语言：Python 3.7
5. 扩展工具包：Keras 2.3.1, Tensorflow 2.1.0
由于采用过于深层的卷积神经网络训练极容易导致过拟合的现象。本文采用基于经验和实验分析，采取四层卷积层，做到尽量精简网络结构，又能提取到足够多的有效信息。如表3-2所示为卷积变分自编码器网络构架及参数，其中 𝑓 代表卷积核/汇合核大小，𝑠 为步长，𝑑 为该层卷积核个数（通道数），𝑝 为填充参数。其中网络训练使用的优化器为 Adam（自适应矩估计），损失函数采用常用的交叉熵损失函数，迭代次数设置为 100 次。
#+Caption: 卷积变分自编码器网络构架及参数
| 操作类型          | 参数信息          | 输入数据维度  | 输出数据维度   |
|----------+--------------------------------------------------------|
| 卷积操作 + relu   | f=3,p=1,s=1,d=64 | (128,128,3)  | (128,128,64) |
| 最大池化          | f=2,s=2          | (128,128,64) | (64,64,64)   |
| 卷积操作 + relu   | f=3,p=1,s=1,d=32 | (64,64,64)   | (64,64,32)   |
| 最大池化          | f=2,s=2          | (64,64,32)   | (32,32,32)   |
| 卷积操作 + relu   | f=3,p=1,s=1,d=16 | (32,32,32)   | (32,32,16)   |
| 最大池化          | f=2,s=2          | (32,32,16)   | (16,16,16)   |
| 卷积操作 + relu   | f=3,p=1,s=1,d=8  | (16,16,16)   | (16,16,8)    |
| 最大池化          | f=2,s=2          | (16,16,8)    | (16,16,4)    |
| Flatten          | -                | (16,16,4)    | (1024)       |
| Dense + relu     | 1024             | (1024)       | (1024)       |
| Reshape          | -                | (1024)       | (16,16,4)    |
| 反卷积操作 + relu | f=3,p=1,s=1,d=8  | (16,16,4)    | (16,16,4)    |
| 最大池化          | f=2,s=2          | (16,16,4)    | (16,16,8)    |
| 反卷积操作 + relu | f=3,p=1,s=1,d=16 | (16,16,8)    | (16,16,16)   |
| 最大池化          | f=2,s=2          | (16,16,16)   | (32,32,16)   |
| 反卷积操作 + relu | f=3,p=1,s=1,d=32 | (32,32,16)   | (32,32,32)   |
| 最大池化          | f=2,s=2          | (32,32,32)   | (64,64,32)   |
| 反卷积操作 + relu | f=3,p=1,s=1,d=64 | (64,64,32)   | (64,64,64)   |
| 最大池化          | f=2,s=2          | (64,64,64)   | (128,128,64) |
| 反卷积操作 + relu | f=3,p=1,s=1,d=3  | (128,128,64) | (128,128,3)  |

基于以上训练模型，模型结果如下，火焰图像送入VAE-CNN网络后，模型中的编码网络提取图像中的特征向量 𝑧 ，与编码网络完全对称的解码网络再根据所提取的关键特征实现对火焰图像数据的重构，编码前后的对比结果如图3-5所示：
#+Caption: VAE-CNN模型编码前后对比图
[[./img/paper/3_en_de_contrast.png]]

由上图可以看出，从火焰图像输入基于变分自编码器的特征提取网络前后的对比，可以观察到经过编码重构后的图像保留了原始火焰图像的主要特征。
提取VAE-CNN的特征变量 𝑧 进行绘制如图3-6所示，可以看出其变化趋势与给煤量变化趋势基本一致。
#+Caption: VAE-CNN模型中特征变量 𝑧 
[[./img/paper/3_z_tesor.png]]

计算 𝑧 中各个特征变量与给煤率曲线之间的相关系数，结果如图3-7(a) 所示，图3-7(b) 是与之对应的相关参数的绝对值。
#+Caption: 模型输出特征参数与给煤率曲线相关关系图
[[./img/paper/3_z_coal.png]]

由上图可以看出，特征向量 𝑧 中的各个变量都与给煤量有着不同程度的相关性，且某几维有着较高的相关性，这样的结果进一步说明了VAE-CNN模型能够很大程度地提取到火焰图像的关键特征信息，完成对火焰图像的特征提取功能。
除此之外，为了更好地验证VAE-CNN模型的性能，本文采取了其他两种网络结构参数一致的自编码器模型进行对比试验，包括自编码器（Autoencoder，AE）和稀疏自编码器（Spare Autoencoder，SAE）。输入上述经过预处理的10800张图像训练模型参数，并采用其他时间段的500张图像数据经过相同处理后进行测试。如表3-3展示了VAE-CNN模型与其他模型，基于上一节所提到的评价指标的计算结果对比。
#+Caption: 不同编码器模型结果指标对比
| 方法      | MSE      |PSNR      | SSIM     | MS-SSIM  |
|----------+-------------------------------------------|
| AE       | 0.0217   | 26.7305  | 0.9215   | 0.8547   |
| SAE      | 0.0134   | 25.9581  | 0.9026   | 0.7968   |
| VAE      | 0.0056   | 30.074   | 0.9463   | 0.9850   |

由上表可知，结合上一节对上表中各指标的介绍，本文采用的基于卷积变分自编码器的特征提取网络模型在各项指标中均获得了最佳性能。综合对比，证明了基于基于卷积变分自编码的火焰图像特征提取网络模型更适合于本文的炉膛煤粉燃烧的火焰图像特征提取任务。
** 本章小结
由于火焰图像包含充分的燃烧状态信息，本章以图像为实验对象，提出卷积变分自编码的特征提取方法，通过建立VAE-CNN网络，调整网络层数及相关参数，完成对火焰图像的特征提取，本文所提出的基于深度学习的网络模型能够有效的对图像的潜在特征进行提取。通过对VAE-CNN网络模型的实验结果进行分析，以及与其他不同方法的实验结果对比，进一步说明了本章所提出的深度学习框架能有效提取火焰特征。本章所提取的潜在向量可作为特征应用于分类任务，为后续章节对炉膛煤粉燃烧进行燃烧状态判别打下了基础。
* 基于k-means和VAE-CNN的无监督聚类框架
# 与师姐文章定量方法进行对比
上一章中提出了采用卷积变分自编码的深度学习框架提取火焰特征，自编码器能够无监督的学习训练数据，通过优化重构自身的损失，它除了能重构原始图像外，还能得到原始图像的稀疏表示，该表示可作为特征应用于分类任务。燃烧是复杂的物化反应过程，随着燃烧进程的推进，火焰燃烧状态不断变化，火焰燃烧状态可根据火焰图像的特征量进行判定。VAE-CNN网络模型有效提取了炉膛燃烧的火焰图像的潜在特征，为了更进一步地运用火焰图像所包含的丰富信息，本章将在上文基础上对燃煤机组进行燃烧状态评估。
** 主成分分析法原理
多变量大数据为研究和应用提供了丰富的信息，但也在一定程度上增加了数据采集的工作量。因此需要找到一种合理的方法，在减少需要分析的指标同时，尽量减少原指标包含信息的损失，以达到对所收集数据进行全面分析的目的。降维是将高维度的数据保留下最重要的一些特征，去除噪声和不重要的特征，从而实现提升数据处理速度的目的。主成分分析法[54]（ Principal Component Analysis，PCA）是一种无监督地将多个相关性较强的原始指标全部转化成几个代表性较强且无相关性的新变量的线性降维方法，把高维数据映射到低维数据空间且尽可能保留了数据的统计信息。
设从编码网络中获得关于火焰图像的特征矩阵为 𝑋，假设线性映射 𝐷 × 𝑑 矩阵 𝑈，使用 𝑈 通过转换 𝑌 = 𝑋𝑈, 将原始样本矩阵 𝑋 转换为矩阵 𝑌。经过转换后，样本数据的协方差定义为：
\[𝑌^{T}𝑌 = (𝑋𝑈)^{T}(𝑋𝑈) = 𝑈^{T}(𝑋^{T}𝑋)𝑈 = 𝑈^{T}𝑐𝑜𝑣(𝑋)𝑈\)]
其中，𝑐𝑜𝑣(𝑋)是原始样本数据𝑋的协方差矩阵。
PCA的目的是求出样本数据的最大协方差。所以，线性映射 𝑈 是由具有 𝑋 的零均值矩阵 𝑐𝑜𝑣(𝑋) 的 𝑑 个特征向量组成。所对应的特征向量可以通过以下公式计算：
\[𝑐𝑜𝑣(𝑋)𝑣 = \lambda𝑣\]
其中 \(\lambda\)，𝑣 分别是 𝑐𝑜𝑣(𝑋) 的特征值和特征向量。
通过这种线性映射，可以根据变换 𝑌 = 𝑋𝑈 将维度为 𝐷 的原始样本 𝑋 变换为维度为 𝑑 的变换数据 𝑌。
** k均值聚类算法原理
K均值聚类算法[55]（k-means clustering algorithm，k-means）是各种不同聚类算法中最常用且最快捷的方法，是一种以距离计算为基础的非常经典的模式识别分类算法，因其聚类具有快速、简单的特性且效果优良、需要调参的参数仅仅是簇数k而得到十分广泛使用。K-means 聚类是动态的过程，通过一次次的迭代更新，使得损失函数的值逐渐降低而逐渐的趋近于聚类的最优解。K-means算法从原始数据集随机选取若干个点作为聚类簇心，并根据距离将所有样本分配到距离最近的簇心中形成若干个集合，并对这些集合进行内部求均值从而获得新的簇心，通过不断的迭代更新直至满足终止条件为止。
K-means 算法的基本流程如下： 
输入：最终聚类的数目K和包含若干样本的数据集 𝑌。
输出：将数据集 𝑌 根据相似性划分为K个部分的集合。
将数据集 \({𝑥^{(1)}, 𝑥^{^{(2)}}, ..., 𝑥^{(m)}}\) 分为 𝑘 个簇，随机选取 𝑘 个聚类簇心为 \(\mu_{1}, \mu_{2}, ..., \mu_{𝑘} 𝜖 R^{𝑛}\)。
1) 对于数据的每个目标点 \(\chi^{i}\)，计算其到每个簇心之间的距离（本文采用欧式距离），距离最小即划分为这个簇内的点：
   \[c^{(i) = argmin_{j}}||\chi^{(i)}-\mu_{j}||^{2}\]
2) 对每一个簇 𝑗，重新计算该簇的簇心:
   \[\mu_{j} = \frac{\sum_{i=1}^{m}l{c^{(i)}=j}\chi^{(i)}}{\sum_{i=1}^{m}l{c^{(i)=j}}}\]
3) 重复 2、3 的步骤，直至收敛。
𝑘 是预先给定的聚类数，\(𝑐^{(i)}\) 表示离目标点𝑥𝑖最近的簇，\(𝜇_{𝑗}\) 是 𝑗 簇的簇心。 
** 基于k-means和VAE-CNN的无监督聚类框架
本章提出了一种基于卷积变分自编码器（CAE-CNN）、主成分分析（PCA）和k均值聚类算法（k-means）的煤粉燃烧状态识别的无监督聚类框架。CAE-CNN模型将输入图像进行压缩编码，并通过压缩表示重构输入图像，以确保压缩变量保留输入图像的关键信息。随后，运用PCA方法将压缩表示作为特征向量投影到正交空间中，进一步确保特征向量中各分量相互独立。最后，将特征向量作为输入数据，送入k-means聚类算法模型中进行聚类分析，用于燃烧状态的在线监测。
具体的流程如图4-1所示：
#+Caption: 基于k-means和VAE-CNN的无监督聚类框架流程示意图
[[./img/paper/4_flow_chart.png]]

基于以上原理，将VAE-CNN网络模型所提取的10800×512维特征向量输入到PCA模型中进行降维处理，结果如图4-2所示，其中图4-2(a) 为数据降维前在原空间的分布情况，图4-2(b) 为数据降维后在新空间的分布情况。由图易知，数据在原空间的分布与新空间的分布基本吻合，表明经无监督模型提取的特征向量经过PCA 降维前后数据主要信息基本保留。
#+Caption: PCA 降维前后数据对比
[[./img/paper/4_pca_pre.png]]

在PCA法中常用主成分的方差贡献率和累计方差贡献率来衡量降维后的数据所包含信息量，主成分可以由协方差矩阵的单位特征向量和原始变量进行线性组合得到：
\[\begin{align}
Y = PX &= \begin{bmatrix} P_{1}\\P_{2}\\\vdots\\P_{n} \end{bmatrix}\cdot\\begin{bmatrix} X_{1}\\X_{2}\\\vdots\\X_{n} \end{bmatrix}
&= \begin{bmatrix} e_{11}&e_{12}&\cdots&e_{1n}\\e_{21}&e_{22}&\cdots&e_{2n}\\\vdots&\vdots&\cdots&\vdots\\e_{n1}&e_{n2}&\cdots&e_{nn} \end{bmatrix}
\cdot\\begin{bmatrix} X_{1}\\X_{2}\\\vdots\\X_{n} \end{bmatrix}
&= \begin{bmatrix} e_{11}X_{1}+e_{12}X_{2}+\cdots+e_{1n}X_{n}\\e_{21}X_{1}+e_{22}X_{2}+\cdots+e_{2n}X_{n}\\\vdots\\e_{n1}X_{1}+e_{n2}X_{2}+\cdots+e_{nn}X_{n}
\end{align}\]
其中，\(P_{1}\) 是由X的协方差矩阵最大特征根 \(\lambda_{1}\) 的单位特征向量 \(e_{1}\) 转置而成，故第一主成分为：
\[Y_{1} = e_{11}X_{1}+e_{12}X_{2}+\cdots+e_{1n}X_{n}\]
第一主成分的方差是最大的。然后第二主成分满足：(1)和第一主成分正交，(2)在剩余的其他主成分中，方差最大，表达式为：
\[Y_{2} = e_{21}X_{1}+e_{22}X_{2}+\cdots+e_{2n}X_{n}\]
同理，第k个主成分的表达式为：
分中，方差最大，表达式为：
\[Y_{k} = e_{k1}X_{1}+e_{k2}X_{2}+\cdots+e_{kn}X_{n}\]
用主成分的方差可以衡量其所能解释的数据集的方差，而主成分的方差就是X的协方差矩阵的特征值 \(\lambda\)，所以第k个主成分的方差就是 \(\lambda_{k}\)。由此，主成分 \(Y_{k}\) 的方差贡献率则是第k个主成分的方差占总方差的比例：
\[\dfrac{\lambda_{k}}{\lambda_{1}+\lambda_{2}+\cdots+\lambda_{n}}\]
那么，前k个主成分的方差累计贡献率为：
\[\dfrac{\lambda_{1}+\lambda_{2}+\cdots+\lambda_{k}}{\lambda_{1}+\lambda_{2}+\cdots+\lambda_{n}}\]
若前k个主成分的方差累计贡献率超过了85%，则表明用前k个主成分去代替原来的n个变量后，而不能解释的方差不足15%，也就是说没有损失太多信息，故可以把n个变量减少为k个变量，以此达到降维的目的。
为了更合理地确定PCA降维后的维数，本文引入主成分的方差贡献率和累计方差贡献率作为判断依据，结果如图4-3所示，其中图4-3(a) 为10800×512维特征向量对应的方差贡献率和累计方差贡献率，图4-3(b) 为特征向量前20个主成分的方差贡献率和累计方差贡献率。由图易知，前面少量维数的主成分在方差贡献率和累计方差贡献率上都获得了较好的的表现，正因如此导致贡献率表视图结果不便观察，故图4-3(b) 仅展示了前20个主成分的方差贡献率和累计方差贡献率便于观察。为了更准确地比较累计方差贡献率从而确定降维维数，展示PCA降维的累计方差贡献率如表4-1所示。
#+Caption: 方差贡献率和累计方差贡献率结果图
[[./img/paper/4_pca_ratio.png]]

#+Caption: 贡献率
| PCA降维维数n    | 方差累计贡献率（%） |
|----------+--------------------------|
| 1                | 77.1060          |
| 2                | 99.7923          |
| 3                | 99.9241          |
| 4                | 99.9655          |
| 5                | 99.9741          |
| 6                | 99.9803          |
| 7                | 99.9839          |        
| 8                | 99.9863          |
| 9                | 99.9884          |
| 10               | 99.9901          |
| 11               | 99.9914          |
| 12               | 99.9925          |
| 13               | 99.9934          |
| 14               | 99.9944          |
| 15               | 99.9951          |

由上表可以看出，前2个主成分的累计方差贡献率便高达99.7923%，前15个主成分累计方差贡献率已经高达99.9951%，说明降维后的数据包含了原数据将近100% 的信息，代表其可以充分代表无监督的VAE-CNN网络模型所提取10800×512维特征向量。故将10800×512维特征向量转换为10800×15维的特征向量，为后续聚类分析打下基础。
将上文无监督的VAE-CNN网络模型提取10800×512维特征向量经PCA降维后的10800×15维的特征向量输入到k-means算法模型中进行聚类分析。火焰的燃烧稳定性判别既要保留火焰本身具有的一定程度的跳动，又要避免火焰闪烁所产生的不确定性影响，因此如果火焰在10s内来回跳动则通过手动划分去除波动。根据人工经验和文献查询知，煤粉燃烧状态分为稳定燃烧、不稳定燃烧和灭火燃烧三种状态是最合理且符合实际意义的，故设定k=3，即设定聚类数为3，聚类结果如图4-4所示：
#+Caption: k=3聚类结果展示
[[./img/paper/4_k_512.png]]

根据上图结果可知看出，将无监督提取的特征向量经PCA降维后送入k-means算法模型后，聚类结果展示出明显的三个类别且界限分明，达到了较好的聚类效果。如图4-5所示，图片展示了将无监督提取的特征向量经PCA降维后送入k-means算法模型输出的聚类标签分布和对应时间的给煤量变化情况，其中标签1对应稳定燃烧状态、标签2对应不稳定燃烧状态、标签3对应灭火燃烧状态，蓝色表示煤粉燃烧的实际状态，橘色表示k-means聚类划分的燃烧状态。由k-means算法模型所得的燃烧状态标签可以看出，该模型划分的燃烧状态与实际燃烧状态基本吻合，能够较好地对燃煤机组进行燃烧状态评估。
#+Caption: 聚类燃烧状态标签分布与对应给煤量变化情况
[[./img/paper/4_kmeans_label.png]]

同时也可看出，k-means的不同燃烧状态间变化均快于实际燃烧状态，分析是由于本文采用的实际燃烧状态是根据给煤量区间划分燃烧状态，具体划分如表4-2所示。Qiu[56]在研究利用火焰图像定量表征燃烧稳定性中，结合实际的背景，依据给煤量将炉膛燃烧状况划分为 3 类，分别为灭火、燃烧不稳定以及燃烧稳定。而根据炉膛燃烧的特性可知，该方法具有一定的滞后性，由此也更进一步说明了基于k-means和VAE-CNN的无监督聚类框的合理性。
#+Caption: 根据给煤量划分燃烧状态数值表
| 给煤量区间    | 燃烧状态     | 对应标签    |
|----------+-----------------------------|
| [53,72]     | 稳定燃烧      | 0         |   
| [27,53)     | 不稳定燃烧    | 1         |
| [0,27)      | 灭火         | 2         |

** 基于无监督聚类的燃烧稳定性定量分析
在上一节中，将基于卷积变分自编码的火焰图像特征提取网络模型所提取的特征向量输入基于k-means和VAE-CNN的无监督聚类框架进行聚类分析，得到了煤粉燃烧的三个状态，分别为稳定燃烧、不稳定燃烧以及灭火状态。为了更全面地描述燃煤机组煤粉燃烧状态，下面通过对上文分析结果进行进一步讨论，以对煤粉燃烧状态进行定量表征。
由于稳定燃烧状态和灭火状态是炉膛内煤粉燃烧状况的两个极限状态，故将其量化为0和100两个值，而不稳定燃烧状态是介于稳定燃烧和灭火两个状态之间的燃烧状态，一次其量化后的数值应介于稳定燃烧和灭火两个状态量化后的值之间，即 0 至 100 的中间数值。通过上述方法，即将煤粉燃烧的三个燃烧状态划分到0至100的区间，由此对煤粉燃烧状态进行定量表征。
k-means是基于划分的一种聚类算法，以距离作为数据对象间相似性度量的标准，即数据对象间的距离越小，相似性越高，越有可能在同一个类簇。数据对象间距离的计算有很多种，本文采用欧氏距离。由于k-means算法的聚类过程中，每次迭代都会对簇中心进行重新计算，也即可以将更新后的簇中心表示为：
# 属于符号不会输入x_{i} 属于C_{k}
\[Center_{k} = \dfrac{1}{C_{k}} \sum_{x_{i}<C_{k}} chi_{i}\]
其中，\(C_{k}\) 表示第k个类簇。。基于此每个燃烧状态的聚类中心便被表示出来：
# 属于符号不会输入x_{i} 属于C_{k}
\[Condition_{k} = \dfrac{1}{C_{k}} \sum_{x_{i}<C_{k}} chi_{i}\]
在本文中则表示不同的燃烧状态，即k的取值范围在 {0,1,2} 之中，当k=0时代表稳定燃烧状态，k=1时代表不稳定燃烧状态，k=2时代表灭火燃烧状态
为了描述每个时刻对应的燃烧状态，引入局部离群因子[57]（Local Outlier Factor，LOF），LOF是基于密度的经典算法，用于发现数据集中的异常模式。在该算法被提出之前，异常通常被认为非黑即白，也就是说，一个样本点要么是正常点，要么是异常点，而LOF量化了每个样本的异常程度。LOF具有简单直观的优点，不需要知道数据集的具体分布就能量化样本点的异常程度。假设数据集D被聚类算法划分到k个类 \(C_{k}\) 中，对象p的离群因子OF3(p) 则被定义为与所有类间距的加权平均值[58]：
\[OF3(p) =  \sum_{j=1}^{k} dfrac{|C_{j}|}{D} d(p,C_{j})\]
其中，|D| 为样本数量，|C_j| 为第j个聚类群体样本数量，d(p,C_j) 为样本p与第j个聚类中心的距离，其中C_j表示第j个聚类中心。则进行基于聚类的离群点诊断过程如下：
1) 对数据集采用合适的聚类算法进行聚类，得到聚类结果。
2) 计算数据集D中所有对象p 的离群因子OF3(p)，及平均值 \(Ave_{OF}\) 和标准差 \(Std_{OF}\)，满足以下条件则为离群点：
   \[OF3(p) \geq\ Ave_{OF}+\beta\Std_{OF}\]
   其中，\(1\leq\\beta\leq\2\) 为阈值参数。
则，每个时刻燃烧状态与燃烧状态聚类中心可以量化为：
\[OF3(x_{j}) =  \sum_{j=1}^{k} dfrac{|C_{j}|}{D} d(x_{j},C_{j})\]
接着，定义燃烧状态权重和燃烧状态的得分表征量。由上文所述，稳定燃烧状态和灭火状态是炉膛内煤粉燃烧状况的两个极限状态，故仅需计算燃烧时刻与稳定燃烧状态和灭火状态的离群因子OF3即可，则有：
\[W_{j} = dfrac{OF3}{\sum_{j=0} OF3}\]
\[S_{j} = 100\cdot\frac{W_{j}-W_{min}}{W_{max}-W_{min}}\]
基于以上原理，在上节基于k-means和VAE-CNN的无监督聚类框聚类分析的基础上，首先计算出燃烧状态的聚类中心，再计算出实验数据每个时刻到稳定燃烧状态和灭火燃烧状态的离群因子，然后计算出燃烧状态的权重，最后便得到燃烧状态质量指标得分情况如下图4-6所示。
#+Caption: 燃烧状态质量指标得分情况
[[./img/paper/4_score.png]]

结合燃烧调整实验给煤量变化情况可知，本文提出的燃烧质量指标得分情况与对应时间给煤量的变化趋势基本吻合，给煤量处于较高水平时，指标得分保持在70到100区间内，并集中在80到100之间。燃烧调整实验减少给煤量时，质量指标得分随之降低，给煤量将为0时，质量指标得分在保持在0至20区间内，集中在0到10之间。给煤量逐渐恢复后，质量指标得分随之升高，又逐渐稳定在80到100区间内。因此，本文提出的燃烧质量指标得分情况可以作为反映燃烧状态的变化量，对煤粉燃烧状态进行定量表征。
上一章对基于卷积变分自编码的火焰图像特征提取网络模型的实验分析中指出了，任意潜在特征中提取某一维特征向量也与给煤量变化趋势有一定程度的相关性，且上一节主成分分析法降维的实验结果也进一步表明潜在特征中的某一维可以较好地反映燃烧状态的变化情况，现在通过计算每一维特征向量与给煤量的相关系数选取出相关系数绝对值最大的第446维特征向量，绘制具体分布如图4-7所示。
#+Caption: 特征向量特征值变化情况
[[./img/paper/4_z_tensor.png]]

结合给煤量变化情况可知，基于卷积变分自编码的火焰图像特征提取网络模型学习的特征向量与给煤量有较好的吻合程度，呈负相关性，当给煤量出于较高水平时，特征分量值数值越小，集中在 -0.1到0之间。给煤量减少时，特征分量值随之增加，给煤量将为0时特征分量值稳定在0.2到0.3之间；给煤量逐渐恢复时，特征分量值随之减少，返回到0以下。故基于本文特征提取模型的第446维特征向量可以在某种程度上作为反映燃烧状态的变化量。
但是通过对比上述两种表征方式的实验结果可知，基于特征分量值的表征相对来说更准确表述的是燃烧状态的区别，当特征分量值大于0时代表燃烧状态恶化，不能很好的描述燃烧质量。而基于离群因子的燃烧状态定量表征方法可以更加动态的描述炉膛煤粉燃烧的燃烧质量，本文提出的表征指标得分情况与给煤量变化趋势更吻合，且对给煤量变化情况更敏感，可以更好的对煤粉燃烧状态进行定量表征。
** 本章小结
本章在上一章的基础上，首先将所提取的火焰图像关键特征经主成分分析法降维处理后，根据实际经验利用k-means聚类算法将燃烧状态划分为3类，分别为煤粉燃烧的稳定、不稳定、灭火燃烧三个状态，进一步证实了VAE-CNN模型对特征提取的有效性，完成了对煤粉燃烧状态的状态判别。其次，在无监督聚类对燃烧状态的判别基础上，进一步对实验结果进行分析，提出了基于聚类划分的燃烧状态定量表征方法，对煤粉燃烧过程进行了更进一步的描述和表征，实验结果证明，该定量表征方法能较好地反映炉膛煤粉燃烧过程的变化情况。
* 基于LSTM和MultiRocket的煤粉燃烧稳定性状态判别模型
# 燃烧定性（LSTM，MultiRocket）
炉膛内的火焰燃烧是动态变化的过程，单帧火焰图像只能表示火焰燃烧的瞬时状态，在一定程度上反映出火焰的燃烧状态，本文所使用的实验数据为电厂燃烧调整实验的视频数据，其中包含着除单帧图像所蕴含潜在特征以外的时间信息，为更加全面准确地描述炉膛内的火焰燃烧状态及其状态变化，本章将利用不同时间序列分类方法（LSTM，MultiRocket），将第二章中提取基于卷积变分自编码的火焰图像特征提取网络模型所提取的特征向量封装为时间序列进行状态判别，提高火焰燃烧状态监测的准确性、可靠性和全面性。
** 基于LSTM的煤粉燃烧稳定性状态判别
时间序列模型应用最广泛效果最优秀的工具通常是递归神经网络[58]（Recurrent Neural Networks，RNN），相比于普通神经网络的各计算结果之间相互独立的特点，RNN的每一次隐含层的计算结果都与当前输入以及上一次的隐含层结果相关。通过这种方法，RNN的计算结果便具备了记忆之前几次结果的特点。
*** LSTM原理
长短时记忆网络[59](Long Short Term Memory Network，LSTM)是一个在长记忆问题方面更完善的特殊RNN，很大程度地解决长序列训练过程中的梯度消失和梯度爆炸问题，与传统RNN相比，其在长时间的信息记忆能力更强。LSTM具有删除或添加节点的能力，通过门信息（输入门、遗忘门和输出门）传递给单元状态。遗忘门决定以前的单元格信息是否传递到当前单元格。输入门确定当前单元格的信息更新，当前单元格的输出由计算得出输出门。每一个门都由神经网络表示，都具备输入层、隐藏层和输出层。 
LSTM 的关键是细胞状态（cell state），表示为 C_t ，用来保存当前 LSTM 的状态信息并传递到下一时刻的 LSTM 中。当前的 LSTM 接收来自上一个时刻的细胞状态 C_{t-1} ，并与当前LSTM接收的信号输入 x_t 共同作用产生当前 LSTM 的细胞状态 C_t。在 LSTM 中，采用专门设计的“门”来引入或者去除细胞状态 C_t 中的信息。门是一种让信息选择性通过的方法。有的门跟信号处理中的滤波器有点类似，允许信号部分通过或者通过时被门加工了；有的门也跟数字电路中的逻辑门类似，允许信号通过或者不通过。
LSTM 在隐藏层加入了状态，使得网络对序列中较长时间前的输入有了记忆的能力。如图5-1所示的是 LSTM 的隐藏层的结构示意图。当序列的第 t 帧输入到网络中时，LSTM 隐藏层的输入包括网络的当前输入 𝑥^𝑡，上一时刻的隐藏层输出向量 h^(𝑡−1)，以及隐藏层状态 𝐶^(𝑡−1)。遗忘门 f 决定状态 C 中的哪些信息被丢弃，输入门 i 决定输入由 𝑥^𝑡 和 h^(𝑡−1) 得到的更新信息中哪些可用于状态 C 的更新，经过遗忘门和输出门，状态 C 的更新完成。
#+Caption: LSTM 隐藏层示意图
[[./img/paper/5_lstm.png]]

加入隐藏层状态的目的是使其对隐藏层的输出 h 产生影响，因此输出门 o用于决定状态 C中的如何作用到 h^𝑡 的计算中。隐藏层的任务是计算并输出向量 ht，并更新状态得到 Ct，为此隐藏层加入了遗忘门 f、输入门 i 以及输出门 o。每个门中都有自己的权重和偏斜，并随着训练过程不断调优，在状态更新和隐藏层输出值的计算上发挥作用。
LSTM链式结构由多个该类小细胞重复模块化连接构成。相对RNN的链式结构，每个细胞元统一使用tanh函数来更新，使网络拥有了长时记忆功能。由于门的控制，避免了梯度消失、梯度爆炸等困难，使细胞元可以在工作时间保持一段时间的信息并且在训练时保持内部的梯度不受不利变化的干扰。
*** 基于VAE-CNN和LSTM的煤粉燃烧稳定性状态判别模型
本文采用基于VAE-CNN和LSTM的网络模型来实现对煤粉燃烧稳定性的状态判别。该模型利用了LSTM在更长的序列中表现更突出的优势，在第三章对炉膛煤粉燃烧火焰图像进行了特征提取的基础上，将所得到的潜在特征加以封装为时间序列，力求在不丢失原始火焰视频数据中的时间信息的情况下，完成对煤粉燃烧稳定性的状态判别。LSTM 网络结构如图5-2所示。LSTM网络由两层隐藏层、全连接层和分类层构成，网络具体参数如表5-1所示。
#+Caption: LSTM网络结构图
[[./img/paper/5_lstm_struc.png]]

#+Caption: LSTM各层网络参数
| 网络层         | 参数                                                             |
|----------+----------------------------------------------------------------------|
| (layer1)      | LSTM(in_dim=512, hidden_dim=64, num_layers=2, batch_first=True) |
| (layer2)      | Linear(in_features=64, out_features=3, bias=True)               |
| (fc)          | Linear(in_features=3, out_features=1, bias=True)                |
| (LogSoftmax)  | LogSoftmax(dim=2)                                               |


基于以上原理，将基于卷积变分自编码网络模型所提取的火焰图像特征输入到LSTM网络模型里，得到结果如表5-2所示。如表5-2所示为基于LSTM的煤粉燃烧稳定性状态判别模型在训练集上的分类精度，其中类别0代表稳定燃烧状态，类别1代表不稳定燃烧状态，类别2代表灭火燃烧状态。
#+Caption: 训练集燃烧状态识别精度
| 数据抓取量  | 类别0    | 类别1    | 类别2    | 总精度    |         
|----------+----------------------------------------------|
| 1         | 0.9584    | 0.9301   | 0.9411    | 0.9408   |
| 5         | 0.9721    | 0.9345   | 0.9626    | 0.9498   |
| 10        | 0.9637    | 0.9287   | 0.9788    | 0.9587   |

经无监督模型提取的特征向量共10800个，其中7200个用于监督训练状态识别模型，3600个作为测试集。如表5-3所示为基于LSTM的煤粉燃烧稳定性状态判别模型在测试集上的分类精度。
#+Caption: 测试集燃烧状态识别精度
| 数据抓取量  | 类别0    | 类别1    | 类别2    | 总精度    |         
|----------+----------------------------------------------|
| 1         | 0.0569    | 0.0516   | 0.0540    | 0.0539   |
| 5         | 0.0576    | 0.0529   | 0.0542    | 0.0554   |
| 10        | 0.1218    | 0.0546   | 0.0752    | 0.0954   |

特征向量输入到LSTM网络后，对燃烧状态的识别精度，在训练集上基本上可以保持95% 上下的训练精度，但是测试集上表现欠佳。于是本文采用不同的数据抓取方式，设置了每次训练中网络不同的数据抓取维度，但测试集、训练集精度均无明显变化。为了更好地挖掘所提取数据蕴含的深层信息，通过实验经验和查阅相关文献，设置了更合理更符合LSTM网络特性的数据组织方式，将原本每个输入向量首尾无连接的组织方式改进为首尾相接并由部分叠加的组织方式，使得单个输入特征中便包含数据的变化趋势，更好地保留数据中的时间信息。
将无监督模型提取的潜在特征重新组织后输入到基于LSTM的煤粉燃烧稳定性状态判别模型中，结果如表5-4所示：
#+Caption: 数据重组后的燃烧状态识别精度
| 数据集    | 类别0    | 类别1    | 类别2    | 总精度    | 
|----------+---------------------------------------------|
| 训练集    | 0.9803   | 0.9471    | 0.9765   | 0.9701   | 
| 测试集    | 0.6719   | 0.5267    | 0.6219   | 0.5834   |

训练集集、测试集上的精度表现均有了较为明显的提升，而且将迭代次数由100个epoch增加为1000时，训练集精度可达到 99% 以上，测试集提升更加明显但仍有很大的提升空间。尽管LSTM可以很大程度上消除梯度消失的问题，但没有解决全部问题。在其计算过程中仍然有一条从过去单元到当前单元的顺序路径，由于网络特性其带有的附加物使得这条路现在更复杂了，并且忽略了隶属于它上面的分支。因此，在面对较为复杂和数量级较大的数据时，仍会存在相同的问题，且每一个LSTM的cell里面都有4个全连接层，在时间跨度大、网络较深的情况下，计算量将会很大耗费较多的时间。
** 基于MultiRocket的煤粉燃烧稳定性状态判别
传统上，时间序列分析涉及分析不同变换下的时间序列数据，例如傅里叶变换，不同的转换和表示显示有关时间序列的不同信息。将时间序列转换为有用的表示形式能够更好地捕捉有意义和指示性的模式，以区分不同或相似的时间序列，从而提高模型的性能，而表现不佳可能会导致性能下降。
*** MultiRocket原理
1. Rocket
   Rocket[60](Random Convolutional KErnel Transform，Rocket)，使用随机卷积核进行异常快速和准确的时间序列分类。Rocket使用大量随机卷积核对输入时间序列进行变换，随机卷积核即具有随机长度、权重、偏差、膨胀和填充的核，并使用转换后的特征用于训练线性分类器，分类器使用岭回归分类器(ridge regression classifier)，其具有对正则化超参数进行快速交叉验证的优势并且没有其他超参数。
   Rocket每个输入时间序列由10000个随机卷积核卷积而成。Rocket将全局最大池和PPV（表示“正值比例”）池应用于结果卷积输出，以在每个输入时间序列中为每个内核生成两个特征，每个输入时间序列总共生成20000个特征。然后，将变换后的特征用于训练线性分类器：岭回归分类器，或使用随机梯度下降（对于较大的数据集）训练的逻辑回归。
   相比于典型卷积神经网络中使用的卷积层，Rocket模型有以下特点：
   1) Rocket使用了非常多的卷积核。由于只有一个“层”内核，并且不需要学习权重，因此计算卷积的成本很低，可以使用非常多的卷积核而计算成本相对较低。
   2) Rocket使用了大量不同的卷积核。在典型的卷积神经网络中，卷积核组通常共享相同的大小、扩展和填充，而Rocket模型中每个卷积核具有随机长度、扩展和填充，以及随机权重和偏差。
   3) Rocket关键地使用了卷积核膨胀（kernel dilation）。与卷积神经网络中扩张的典型使用相比，扩张随深度呈指数增长。Rocket对每个卷积核的膨胀进行随机抽样，产生种类繁多的核膨胀，用于捕获不同频率和尺度的模式。
   4) 除了使用生成的特征图的最大值（即全局最大池化）之外，Rocket还使用了一个额外的新的特征：正值的比例（the proportion of positive values (or PPV)）。这使分类器能够对时间序列中给定模式的出现频率进行加权，以提高模型精度。PPV计算公式为：
      \[ppv(Z) =  \frac{1}{n} \sum_{i=1}^{n-1} [Z_{i}>0]\]
      其中，Z 表示卷积操作的输出。
   Rocket给出了随机设定卷积核的方式，具体参数包括：Length, Weights, Bias, Dilation, Padding, Stride。其次Rocket的每个卷积核产生两个特征：最大值MAX(maximum value)和正直的比例PPV(proportion of positive values)。
2. MiniRocket
   Rocket 所使用的卷积核长度从 {7, 9, 11} 中随机选择，从 N (0, 1) 中抽取权重，从 U (-1, 1) 中抽取偏置项，随机膨胀和填充。每个卷积核计算两个特征，PPV和最大值，总共20000个特征。但是Rocket需要大量的卷积核才能取得较好的分类准确率，且在使用固定的随机卷积核时，对于非常大的数据集，学习可能会在某些时候“饱和”。MiniRocket[61]为了解决上述问题，针对性地在长度、权重、偏差、膨胀和填充的参数设置上对卷积核进行了关键的调整，并由此产生了相应的特征更改，如表5-5所示。
   #+Caption: 从Rocket到MiniRocket的参数调整
   |               | Rocket           | MiniRocket                   |
   |-------+---------------------------------------------------------|
   | length        | {7, 9, 11}       | 9                            |
   | weights       | \(\nabla(0, 1)\) | {-1, 2}                      |
   | bias          | \(\mu(-1, 1)\)   | from convolution output      |
   | dilation      | random           | fixed (rel. to input length) |
   | padding       | random           | fixed                        |
   | features      | PPV + max        | PPV                          |
   | num. features | 20K              | 10K                          |

   由表5-4可知，MiniRocket卷积核的长度统一设定为9。权重被限制为 \(\alpha = -1\) 和 \(\beta = 2\)两个数。卷积核表示为 \(\alpha\) 和 \(\beta\) 的组合；偏置值是从卷积输出中提取，对于一个随机选择的训练样本，给定一个卷积核，计算其输出的 \(W_{d}*X\) 然后取 [0.25, 0.5, 0.75] 分位数作为偏置的可选值。填充使用标准的0填充。偏置值是MiniRocket中唯一的随机值，在实验中通过整个训练数据集来计算得到偏置值。膨胀值的范围为
   \[D = {[2^{0}], ..., [2^{max}]}\]
   \[max = log_{2}\tfrac{\iota_{input}-1}{\iota_{kernel}-1}\]
   其中，\(\iota_{input}\) 是输入时间序列的长度，\(\iota_{input}\) 是卷积核长度。
   MiniRocket利用小型、固定的二值卷积核集和PPV的特性，通过以下四个关键优化显著加快转换卷积核转换输入时间序列的速度：
   1) 同时计算W和-W的ppv值，即两个数值相同但符号相反的卷积核，因此其对原始序列进行卷积操作，只需要计算其中1个的输出，就可获得另一个输出；
   2) 利用卷积操作的输出进行多个特征的计算，比如偏置值，达到使用单个卷积运算的计算成本计算多个特征的目的；
   3）将内核权重限制为两个值，从而在卷积运算中“分解”乘法，仅使用加法来执行卷积运算，避免卷积运算中的乘法带来的较大计算量；
   4) 使用仅有两个值的卷积核几乎可以通过一次运算计算所有的卷积核。
3. MultiRocket原理
   在Rocket和MiniRocket的基础上进行改进，同一拨人提出了MultiRocket[62]，通过扩展变换产生的特征集，在增加少量额外计算量的基础上显著提高其准确性。与Rocket一致，MultiRocket使用大量卷积核转换时间序列，从卷积输出计算特征来训练线性分类器。MultiRocket首先通过将原始时间序列作为基础时间序列转换为其一阶差分以增加 MiniRocket 的多样性，时间序列的一阶差分描述了每个单位时间步长之间时间序列的变化率包含了时间序列的更多附加信息；并且每个内核使用的额外3个池化算子，将卷积应用于基础时间序列和一阶差分时间序列，通过更多的特征组合方式，取得了较好的分类精度。
   MultiRocket使用与MiniRocket中使用相同的固定内核集，产生高分类精度并允许高度优化的变换。MultiRocket 使用长度为 9 的卷积核。权重限制为 {-1, 2} 两个值，其中6个权重值为 -1，3个权重值为2，例如W = [-1, -1, -1, -1, -1, -1, 2, 2, 2]。在这种排列下总共84个固定卷积核。每个卷积核/扩张组合的偏差值来自卷积输出，计算随机选择的训练示例的卷积输出，并将该输出的分位数作为偏差值，训练样本的随机选择是这些内核的唯一随机方面。填充在卷积核/扩张组合之间交替，一半的卷积核/扩张组合使用填充，而一半不使用，填充方式为标准0填充。每个内核使用相同（固定）的膨胀集，膨胀集范围设置为
   \[D = {[2^{0}], ..., [2^{max}]}\]
   \[max = log_{2}\tfrac{\iota_{input}-1}{\iota_{kernel}-1}\]
   其中，\(\iota_{input}\) 是输入时间序列的长度，\(\iota_{input}\) 是卷积核长度。
   在卷积操作之后，MultiRocket计算每个卷积输出Z的4个特征，长度为n，这些特征总结了 Z 中的值，也称为池化算子。具体如下所示：
   1) 正值占比（Proportion of positive values，PPV）
      PPV 是在Rocket中引入的，计算来自卷积输出Z的正值的比例，与偏置项直接相关，偏置项可以看作是PPV的“阈值”，如公式所示。正偏置值意味着PPV能捕获反映输入和给定模式之间甚至弱匹配的时间序列的比例，而负偏差值意味着PPV仅捕获反映输入和给定模式之间强匹配的输入比例。
      \[ppv(Z) =  \frac{1}{n} \sum_{i=1}^{n-1} [Z_{i}>0]\]
      其中，Z 表示卷积操作的输出。
   2) 正值的平均值（Mean of positive values，MPV）
      MPV用来表示卷积输出中正值的大小，Z 长度为n，计算公式如下。MPV也与偏置项有关，捕获输入时间序列和给定模式之间的匹配强度，即计算PPV时可用但被丢弃的信息，也就是说仅需要可忽略的额外计算成本。
      \[MPV(Z) = \dfrac{1}{m} \sum_{i=1}^{m} z_{i}^{+}\]
      其中，\[z^{+}\] 长度为m且 \(PPV(Z) = \tfrac{|Z^{+}|}{n} = \tfrac{m}{n}\) 的正值向量。
   3) 正值指数的平均值（Mean of indices of positive values，MIPV）
      MIPV表示有关正值在卷积输出中的相对位置的信息，将卷积输出Z视为一个值数组，首先记录数组中所有正值的相对位置来计算，计算指数的平均值，如下公式所示。计算 PPV时也可以使用正值的索引，MIPV略的额外成本计算也可忽略。
      \[MIPV(Z) = \begin{cases}
        \dfrac{1}{m} \sum_{j=1}^{m} i_{j}^{+}, if m>0\\
        -1, otherwise
        \end{cases} \]
      其中 \(I^{+}\) 表示正值的指数，m 是Z中正值的数量。
   4) 最长的正值延伸（Longest stretch of positive values，LSPV）
      MIPV表示所有正值，但无法区分许多连续正值的小序列和少量长序列，缺少了部分基础时间序列的信息。LSPV返回卷积输出中正值的任何子序列的最大长度，表示了关于卷积输出中正值的不同形式的信息，使用如下公式计算。
      \[LSPV(Z) = max[j-i] A_{i\leq\k\leq\j}Z_{k}>0\]
   默认情况下，MultiRocket产生大约50000个特征，转换后的特征用于训练线性分类器，默认使用ridge回归分类器。数据集较大时使用训练速度更快的逻辑回归分类器。   
*** 基于VAE-CNN和MultiRocket的煤粉燃烧稳定性状态判别模型
本文采用基于VAE-CNN和MultiRocket的网络模型来实现对煤粉燃烧稳定性的状态判别。该模型利用了MultiRocket在时间序列处理上的强大优势，在第三章对炉膛煤粉燃烧火焰图像进行了特征提取的基础上，将所得到的潜在特征封装为时间序列，力求在不丢失原始火焰视频数据中的时间信息的情况下，送入到MultiRocket网络模型中，通过使用随机卷积核转换时间序列，并使用转换后的特征训练分类器，以完成对炉膛煤粉燃烧稳定性的状态判别。MultiRocket网络结构如图5-3所示。
#+Caption: MultiRocket网络结构示意图
[[./img/paper/5_multirocket.png]]

首先将原始时间序列转换为其一阶差分时间序列，然后将卷积应用于基本和一阶差分时间序列，使用不同的膨胀和偏差集来生成特征图，在卷积操作之后MultiRocket计算每个卷积输出 Z 的四个特征，即正值比例 (PPV)、正值平均值 (MPV)、正值指数平均值 (MIPV) 和正值最长延伸 (LSPV)，转换后的特征用于训练线性分类器。由于一阶差分时间序列比基本时间序列短一个值，因此，一阶差分时间序列的最大膨胀将比基本时间序列短，故导致内核集与基本时间序列略有不同；一阶差分时间序列也具有与基本时间序列不同的值范围，从而导致一组不同的偏差值。除此之外，基本和一阶差分时间序列的长度、权重和填充是相同的。MultiRocket的网络参数如下表5-6所示。
#+Caption: 。MultiRocket网络参数
| 参数            | 范围                             |
|-------+-------------------------------------------|
| 卷积核尺寸    | 9                                  |
| 权重         | {-1, 2}                            |
| 偏置         | 由卷积输出                          |
| 膨胀集       | \(D = {[2^{0}], ..., [2^{max}]}\)  |
| 填充         | 在内核/扩张组合之间交替               |
| 特征量       | PPV + MPV + MIPV + LSPV            |
| 特征数目     | 50K                                |

基于以上原理，通过无监督方法提取的火焰图像特征输入到MultiRocket网络模型中，原始时间序列被转换为其一阶差分时间序列，卷积操作作用在两种序列上，包括卷积核和时间序列之间的滑动点积，84个卷积核使用不同的膨胀集和偏差集生成特征图，在卷积操作后每个卷积输出Z的4个特征值，然后使用变换后得到的特征来训练线性分类器。实验结果如表5-7所示，其中类别0代表稳定燃烧状态，类别1代表不稳定燃烧状态，类别2代表灭火燃烧状态。
#+Caption: MultiRocket模型燃烧状态识别精度
|           | 类别0    | 类别1    | 类别2    | 总精度    |  
|----------+---------------------------------------------|
| 训练集    | 0.9861    | 1.0      | 1.0       | 0.9989   |
| 测试集    | 1.0       | 0.9644   | 1.0       | 0.9856   |

经无监督模型提取的特征向量共10800个，其中7200个用于监督训练状态识别模型，3600个作为测试集。实验中MultiRocket产生约5000个特征：基于无监督方法提取的特征向量作为时间序列输入模型后被转换为一阶差分形式，即原始数据产生了2中时间序列表示方式，模型由6216个卷积核构建，每个卷积核计算出4个特征值（池化算子），故模型总共产生2×6216×4 = 49728个特征。这转换后的近5000个特征又被用于训练ridge回归分类器，从而计算出燃烧状态的判别精度。
由上表展示的实验结果可知，基于MultiRocket的煤粉燃烧稳定性状态判别模型在训练集和测试集数据的不同燃烧类别上均有良好的表现，尤其时在代表灭火燃烧状态的类别2表现尤为突出，达到了100% 的精度。在代表稳定燃烧、不稳定燃烧的类别0、类别1上，由之前的调整实验可知该两类上存在不同程度的波动，但该方法也均能达到接近100% 的精度，说明了MultiRocket模型能很好地运用在煤粉燃烧过程的状态判别中，也验证了其合理性、准确性。
** LSTM和MultiRocket实验结果对比分析
时间序列数据被定义为一组数据点，其中包含有关不同时间点的详细信息。通常，时间序列数据包含以相等的时间间隔采样/观察的数据点。时间序列分类是识别数据中与各个类别相关的模式和信号的任务。通过无监督特征提取的潜在向量即可以视作是将统计指标的数值，按时间先后顺序排序所形成的数列，而对炉膛煤粉燃烧状态进行判别即为通过对某种序列进行分类对相关事物动态变化过程进行识别，深入了解其内在规律。
LSTM在RNN结构以外添加了各层的阀门节点（遗忘阀门，输入阀门、输出阀门）。这些阀门可以打开或关闭，用于将判断模型网络的记忆态在该层输出的结果是否达到阈值从而加入到当前该层的计算中。阀门节点利用sigmoid函数将网络的记忆态作为输入计算，如果输出结果达到阈值则将该阀门输出与当前层的计算结果相乘作为下一层的输入，如果没有达到阈值则将该输出结果遗忘掉。每一层包括阀门节点的权重都会在每一次模型反向传播训练过程中更新。
不同于LSTM，MultiRocket是由随机生成的卷积核对时间序列数据进行卷积生成的特征，从而产生更快、更好的时间序列分类器。MultiRocket独特地用卷积核并从每个卷积核生成4个特征，不使用隐藏层或任何非线性且产生的特征是相互独立的，其膨胀值不会随着深度呈指数增长而是在一定范围内的随机膨胀值，最重要的是MultiRocket拥有独特的池化算子，即正值比例 (PPV)、正值平均值 (MPV)、正值指数平均值 (MIPV) 和正值最长延伸 (LSPV)。
为了更好地评判基于LSTM和MultiRocket的煤粉燃烧稳定性状态判别，将两种方法互相对比，对比结果如表5-8所示。
#+Caption: LSTM与MultiRocket实验结果对比
|              | 训练集精度  | 测试集精度  | 总训练时间  |  
|----------+-----------------------------------------|
| LSTM         | 0.9701    | 0.5834     | 1.89 h     |
| MultiRocket  | 0.9989    | 0.9856     | 77.58 s    |
   
由上表5-5实验结果易知，LSTM算法模型应用于本文实验数据时在训练集上的表现良好，分类精度高达97%，但在测试集上的表现欠佳，分类精度仅有58%。LSTM虽然可以解决长期依赖的问题，但由于隐藏层信息容量即隐藏单元个数有限，导致模型能力存在上限。而训练集效果好测试集效果差通常是因为模型泛化能力差，泛化能力差也就是说使用训练集进行训练好模型，而测试集中可能会出现训练集没有出现的情况，这个时候模型预测没有出现的情况效果会一定程度下降。泛化能力差的原因一般包括两种，一种是模型欠拟合，另一种是模型过拟合。欠拟合通常是训练集和测试集效果都不好；过拟合通常是训练集效果好，测试集效果不好。显然本文结果更倾向于时模型过拟合，出现此类问题通常与所建模型相关，需要调整模型即参数调整，而参数调整往往需要依赖于经验判断，这也就导致模型会很大程度以来人工经验。LSTM相对于传统的RNN，在模型参数不改变的情况下步长也会变长，正向传播和反向传播的步骤也变多了，训练量也就增加了，且LSTM为时间序列模型，时间t时刻要依赖时间 t-1时刻信息，不能并行执行，故训练时间消耗也很大。
上表5-5实验结果中，MultiRocket在训练集、测试集上均表现良好，分类精度均接近100%。MultiRocket 应用一阶差分来转换时间序列，然后使用四个池化算子PPV、MPV、MIPV和LSPV从原始序列和一阶差分序列的卷积输出中提取汇总统计信息。将卷积应用于时间序列最大优势在于突出序列的有用属性，因此在这些卷积中分离相关信号的方法尤为高效。MultiRocket使用一组小的、固定的卷积核集，并且几乎完全是确定的，其池化算子的计算成本也比较低，使得其在保证良好精度的同时，在训练时间成本的表现也达到了领先水平。
** 本章小结
本章简要介绍了长短时记忆网络和MultiRocket时间序列分类方法的基本原理、主要特点和优势，在第三章无监督特征提取的基础上，将潜在特征作为时间序列分布输入到基于LSTM和MultiRocket的煤粉燃烧稳定性状态判别模型中，在训练集、测试集上展示了良好的表现，更好地解释了实验数据中的时间行为。通过对两种方法在精度和时间上实验结果的对比，更客观地评判二者对燃烧状态判别的精度，以及其在时间成本上的耗费，证实其运用在实际工作中的合理性和可行性。

* 总结
在当前国家战略转型、经济能源结构调整、可再生能源快速发展的大背景之下，对在我国电源构成中占比过半的燃煤机组进行实时监测的必要性、迫切性和重要性更显得尤为突出。燃烧火焰是煤粉燃烧状态稳定与否的最直接反映，其中蕴含着丰富的燃烧信息，利用基于火焰图像的检测技术进行切实有效的火焰检测和燃烧诊断，研究燃烧系统火焰稳定性，达到最优的燃烧过程，降低污染物排放，提升电厂的安全运营，故其稳定性检测与评价对锅炉的安全经济运行有着重要的作用。为合理地应对当前形势，结合炉膛燃烧图像的动态过程，建立能对煤粉燃烧过程进行动态描述的物理表征量更是迫在眉睫。本文利用在吉林某600MW燃煤机组进行的燃烧调整实验，运用图像检测装置采集实验过程中的火焰视频图像和对应给煤量变化数据，提出了基于火焰图像的炉膛燃烧稳定性定量分析方法。首先，利用卷积神经网络和变分自编码强大的学习能力，将二者结合搭建卷积变分自编码器提取火焰图像中的潜在特征。其次，加深对无监督学习的特征向量的分析运用，搭建基于k-means的无监督聚类框架，将煤粉燃烧过程分为3个不同状态，并利用聚类结果对煤粉燃烧进行定量表征进一步提升对燃烧过程的描述能力。最后，在给定燃烧状态标签的基础上，利用长短时记忆网络和MultiRocket模型对无监督提的潜在特征进行时间序列分析，挖掘火焰图像动态变化的时间语义，取得良好的精度，为燃煤机组燃烧过程检测提供了合理有效的判别方法。
本论文主要完成了以下工作：
1. 介绍了当前国内外专家学者在燃烧火焰稳定性判别方面提出的各种方法及研究成果，说明了火焰图像的重要性与深度学习二者结合应用到燃烧状态判别的必要性。简述了燃煤机组的煤粉燃烧过程和燃烧特性，以及本文所采用的某600MW燃煤机组燃烧调整实验的实验设备和实验过程，选取燃烧调整实验中稳定时段、变负荷、给煤量波动较大时段收集3个小时的视频中的火焰图像，经过平滑处理和设定模板裁剪后变换为合适尺寸的实验数据。
2. 采用基于卷积变分自编码器的火焰图像特征提取模型，得到原始火焰图像的特征表示，完成了对炉膛煤粉燃烧火焰图像的特征提取，为后续燃烧状态评估打下基础。针对变分自编码器非监督的学习复杂分布且易于与其他深度学习网络结合的突出优点，与在图像相关研究方面具有强大优势的卷积神经网络相结合搭建了VAE-CNN网络模型，调整网络结构和相关参数，实现了对火焰图像的特征提取，实验结果表明，该网络模型提取的特征向量能够较好地代表原始图像的关键信息和潜在特征，在同其他方法的对比结果上也表现出良好的合理性和准确性。
3. 采用主成分分析法对由火焰图像无监督提取得到的潜在特征进行了降维处理，在不减少原始潜在特征所包含信息的前提下把高维数据映射到低维数据空间，去除噪声和不重要的特征进而提升后续对燃烧数据进行状态判别的处理速度。运用无监督聚类的k-means算法模型对降维后的特征向量进行了聚类分析，将煤粉燃烧状态划分为稳定燃烧、不稳定燃烧、灭火3类不同的燃烧状态。然后，在无监督聚类燃烧状态划分的基础上，定义物理定量表征指标，对煤粉燃烧的动态过程进行质量描述，并结合对应给煤量变化情况进行分析，证实了所提出表征指标的合理性和可行性。
4. 采用时间序列分析方法长短时记忆网络和MultiRocket对无监督提取的特征向量进行实验分析。由于火焰图像本身是具有时间行为的数据，故将基于卷积变分自编码器提取的潜在特征封装为符合模型特性的时间序列输入到上述两种模型中，相比于前几点中方法更大程度地挖掘数据本身的时间行为，实验结果表明，长短时记忆网络在数据集上取得良好效果，MultiRocket在训练集和测试集中均取得良好精度均达到了接近100% 的优异表现，并且在总训练时间的成本耗费上也具有明显优势，完成了对燃烧状态的判别分析，证实了所提出的基于长短时记忆网络和MultiRocket的煤粉燃烧稳定性状态判别模型的可行性。
* 参考文献
[1] 中电联. 2021 - 2022年度全国电力供需形势分析预测报告[Z]. 2022. 
[2] 段志强. 低负荷稳燃技术在燃煤锅炉中的应用[J]. 山东工业技术, CNKI: SUN: SDGJ. 0. 2019-05-174. 
[3] MALMGREN A, RILEY G. 5.04 - Biomass Power Generation[J]. SAYIGH A. Oxford: Elsevier, 2012: 27-53. 
[4] 佘星星, 黄福珍. 锅炉火焰图像特征及燃烧状态智能监测综述[J]. 上海电力学院学报, 2010, 26(4): 399-405.
[5] 华彦平, 邹煜, 吕震中. 现代燃煤电站锅炉火焰检测综述[J], 热能动力工程,2001,16(1). 
[6] http://www.110ye.com/news/340530-732734.html[OL]. (北京国电海明科技发展有限公司: SFSSS炉膛安全监视保护仪). 
[7] 徐益谦, 现代锅炉火焰检测技术的新进展[M]. 北京:科学出版社,2000. 
[8] 甄成刚, 基于图像处理技术的炉膛火焰检测方法研究[D]. 保定:华北电力大学,2004. 
[9] 佘星星, 黄福珍. 锅炉火焰图像特征及燃烧状态智能监测综述[J]. 热能动力工程,2010.(08). 
[10] 张清宇. 火焰燃烧稳定性诊断方法研究[D]. 杭州:浙江大学,2004. 
[11] HWANG C-H, LEE S, KIM J-H, et al. An experimental study on flame stability and pollutant emission in a cyclone jet hybrid combustor[J]. Applied Energy, 2009, 86(7): 1154–1161.
[12] 华彦平. 现代燃煤锅炉火焰检测综述[J]. 热能动力工程,2001,(16):1-6. 
[13] 马骏, 余岳峰, 范浩杰. 基于频谱分析和自组织神经网络的火焰燃烧诊断研究[J]. 动力工程学报, 2004(06): 852–856. 
[14] KRANZ C .A new flame detection method for two channels infrared flame detectors[A]. Institute of Electrical and Electronics Engineers 29th Annual 1995 International Carnahan Conference on 18~20 Oct[C]. Sanderstead UK: Digital Object Identifier,1995.209- 213. 
[15] 熬丽敏, 黎建华, 宋轩等. 一种基于自适应小波变换的火焰检测方法的研究. 热能动力工程，2006，21(6):594-597. 
[16] DAUBECHIES I. The wavelet transform, time-frequency localization and signal analysis[J]. IEEE Trans Inform Theory, 1990, 36(5): 961-1005.
[] JONES A R. Flame Failure Detection and Modern Boilers[J]. Journal of Physics E: Scientific Instruments, 1988, 21(10): 921–928.
[17] 高翔, 骆仲涣, 陈亚非, 周劲松, 倪明江, 岑可法. 电站锅炉燃烧实时诊断应用技术[J]. 电站系统工程, 1998, 14(3). 
[18] 高翔, 骆仲映, 陈亚非, 周劲松, 倪明江, 岑可法. 应用微压探测诊断燃烧状况的实验研究[J]. 动力工程, 1998, 18. 
[19] 高翔, 骆仲映, 陈亚非, 周劲松, 倪明江, 岑可法. 锅炉实时燃烧诊断系统的开发[J]. 热力发电, 1999, (6). 
[20] 肖隻, 王一清, 吕震中. 基于炉膛微压信号的锅炉燃烧诊断试验研究[J]. 锅炉技术, 2002, 33(7):12-15. 
[21] 高翔, 骆仲映, 陈亚非等. 应用微压探测诊断燃烧状况的试验研究化动力工程, 1998, 18(4):27-31, 14. 
[22] 马骏, 余岳峰, 范浩杰. 基于频谱分析和自组织神经网络的火焰燃烧诊断研究[J]. 动力工程学报, 2004(06): 852–856. 
[23] SHIMODA M, SUGANO A, KIMURA T, et al. Prediction Method of Unburnt Carbon for Coal Fired Utility Boiler Using Image Processing Technique of Combustion Flame[J]. IEEE Transactions on Energy Conversion, 1990, 5(4): 640–645.
[24] 蔡小舒, 季馄, 苏明旭等. 基于光谱分析的煤粉火焰复合判据和燃烧诊断研究[J]. 中国电机工程学报, 2004, 24(1):211-215. 
[25] Kurihara N, Nishikawa M. A Combustion Diagnos is Method for Plverized Coal Boilers Using Flame Image Recogniting Technology[J]. IEEE Transactiong on Energy Conversion, 1986, 1(2): 99-103. 
[26] Mitsubishi Heavy Industrialists. Specfication of Flame Detector[M]. 1997. 
[27] Takamura Shozo, et al. Evaluation of the Combustion Condition of Refuse Incinerator by th Image of the inside Color of Flame and Self-organization of Learning of the Incinerator inside us using Kohonen networks[J]. Gazo Rabo, Vol 9, No.3, 1998: 44-6. 
[28]K. Sujathal, Dr. N. Pppa2. Flame Image Analysis for Combustion Quality Estimation in Pawer Station Boilers using Classification Algorithms[Z]. Chennai and Dr. MGR University Second International Conference on Sustainable Energy and Intelligent System, India. July. 20-22, 2011. 
[29] 吴占松. 发光火焰的图像处理及其在燃烧检测中的应用[D]. 博士. 北京: 清华大学, 1988. 
[30] 徐伟勇, 余岳蜂, 孙江等. 数字图像处理技术在火焰检测上的应用[J]. 中国电力, 1994, (10): 41-44. 
[31] 周怀春, 娄新生, 邓元凯. 基于辐射图象处理的炉膛燃烧三维温度分布检测原理及分析[J]. 中国电机工程学报, 1997, 17(1): 1-4. 
[32] 周怀春, 娄新生, 肖教芳等. 炉膛火焰温度场图象处理试验研究[P]. 中国电机工程学报, 2000, 20(7): 40-43.
[33] 王式民, 吕震中. 图像处理技术在全炉膛火焰监测中的应用[J]. 动力工程, 1996, 16(6): 5. 
[34] 刘禾, 程伟良. 基于火焰序列图像的煤粉燃烧稳定性判别[J]. 动为工程, 2004, 24(5): 681-689.
[35] 韩璞, 张欣, 王兵. 基于神经网络的交互式炉膛火焰图像识别[J]. 中国电机工程学报, 2008, 4(20): 22–26.
[36] 刘禾. 基于火焰图像和模糊神经网络的锅炉燃烧稳定性判别[J]. 仪器仪表学报, 2008(06): 1280–1284. 
[37] 徐宝昌, 张丁元, 程亮. 基于图像的火焰稳定性判别方法研究[J]. 计算机工程与应用, 2012, 48(09): 168–171. 
[38] DAO-GUANG L, LI-XIA L, CHANG-LIANG L, 等. Flame Furnace in Thermal Power Plant Condition Monitoring Using SVM[C]. 2009 Second International Conference on Intelligent Computation Technology and Automation. 2009: 67–70. 
[39] 吴一全, 朱丽, 周怀春. 基于Krawtchouk矩阵和支持向量机的火焰状态识别[J]. 中国电机工程学报, 2014, 34(5): 734–740. 
[40] LI W, WANG D, CHAI T. Flame Image-Based Burning State Recognition for Sintering Process of Rotary Kiln Using Heterogeneous Features and Fuzzy Integral[J]. IEEE Transactions on Industrial Informatics, 2012, 8(4): 780–790. 
[41] WANG Z, SONG C, CHEN T. Deep Learning Based Monitoring of Furnace Combustion State and Measurement of Heat Release Rate[J]. Energy, 2017, 131: 106–112. 
[42] QIU T, YAN Y, LU G. A Medial Axis Extraction Algorithm for the Processing of Combustion Flame Images[C]. 2011 Sixth International Conference on Image and Graphics. 2011: 182–186.
[43] QIU T, YAN Y, LU G. A three-dimensional shape descriptor for burner flames[C]. 2012 IEEE International Conference on Imaging Systems and Techniques Proceedings. 2012: 506–509.
[44] SUN D, LU G, ZHOU H, et al. Flame Stability Monitoring and Characterization Through Digital Imaging and Spectral Analysis[J]. Measurement Science and Technology, 2011, 22(11): 114007.
[45] 白卫东, 严建华, 池涌, 等. 基于图像技术和PCA方法的火焰监测研究[J]. 动力工程, 2004(01): 87–90.
[46] CHEN J, HSU T-Y, CHEN C-C, et al. Monitoring combustion systems using HMM probabilistic reasoning in dynamic flame images[J]. Applied Energy, 2010, 87(7): 2169–2179.
[47] BAI X, LU G, HOSSAIN M M, et al. Multi-mode combustion process monitoring on a pulverised fuel combustion test facility based on flame imaging and random weight network techniques[J]. Fuel, 2017, 202: 656–664.
[48] Vahdat, A. & Kautz, J. Larochelle, H.; Ranzato, M.; Hadsell, R.; Balcan, M. F. & Lin, H. (Eds.) NVAE: A Deep Hierarchical Variational Autoencoder. Advances in Neural Information Processing Systems, Curran Associates, Inc., 2020, 33, 19667-19679. 
[49] Kingma D P, Welling M. Auto-encoding variational bayes[J]. arXiv preprint arXiv: 1312.6114, 2013. 
[50] Alex Krizhevsky, Ilya Sutskever, Geoffrey E Hinton. ImageNet classification with deep convolutional neural networks[J]. Communications of the ACM, 2017, 60(6).
[51] 王宇庆, 刘维亚, 王勇. 一种基于局部方差和结构相似度的图像质量评价方法[J]. 光电子．激光, 2008, 19(11):8.
[52] Wang Z, Bovik A C, Sheikh H R, et al. Image quality assessment: from error visibility to structural similarity[J]. IEEE Transactions on Image Processing (TIP), 2004, 13(4): 600-612. 
[53] Wang  Z,  Simoncelli  E  P,  Bovik  A  C.  Multiscale  structural  similarity  for  image  quality assessment[C]//The Thrity-Seventh Asilomar Conference on Signals, Systems & Computers, 2003. Ieee, 2003, 2: 1398-1402. 
[54] Jolliffe I T, Cadima J. Principal component analysis: a review and recent developments[J]. Philos Trans A Math Phys Eng, 2016, 374(2065): 1-16.
[55] Gachhadar A, Acharya ON. K-means based energy aware clustering algorithm in wireless sensor network[J]. Intermational Journal of Scientific&Engineering Research, 2014, 5(5): 156-160.
[56] Qiu T, Liu M, Zhou G, et al. An Unsupervised Classification Method for Flame Image of Pulverized Coal Combustion Based on Convolutional Auto-Encoder and Hidden Markov Model[J]. Energies, 2019, 12(13).
[57] Breunig M M ,  Kriegel H P ,  Ng R T , et al. LOF: Identifying Density-Based Local Outliers[J]. Proc.acm Sigmod Int.conf.on Management of Data, 2000.
[57] 周英, 卓金武, 卞月青. 大数据挖掘:系统方法与实例分析[M]. 机械工业出版社, 2016.
[58] Graves A, Jaitly N. Towards end-to-end speech recognition with recurrent neuralnetworks[C//International conference on machine learning. 2014: 1764-1772.
[59] Greff K, Srivastava R K, J Koutník, et al. LSTM: A Search Space Odyssey[J]. IEEE Transactions on Neural Networks and Learning Systems, 2017.
[60] Dempster A, Petitjean F, Webb GI (2020) ROCKET: Exceptionally fast and accurate time series classification using random convolutional kernels. Data Mining and Knowledge Discovery 34(5):1454–1495. 
[61] Dempster A, Schmidt DF, Webb GI (2021) Minirocket: A very fast (almost) deterministic transform for time series classification. In: Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery & Data Mining, pp 248–257Demsar J (2006) Statistical comparisons of classifiers over multiple data sets. Journal of Machine learning research 7(Jan):1–30. 
[62] Chang W, Dempster A, et al. MultiRocket: Effective summary statistics for convolutional outputs in time series classification. arXiv, 2021.
* 致谢
又一年夏天将至，硕士阶段也即人生最后的学生时代，亦将在夏天的北京画上句号。自研二下学期，我们便笼罩在疫情的阴霾之下，至今未散，然而纵使环境如何变幻，前路总是散发着理想的光辉。本人此生有幸，受家人疼爱，受朋友照顾，有良师教诲，仅有的烦扰也只是杞人忧天式地放大了某些小挫折罢了，硕士三年期间尤是如此。诸多思绪翻涌，楮墨有限，难表厚谊，意在言外！
首先，我要感谢我的导师邱天老师，循循善诱，谆谆教诲，感谢邱老师将我收入门下，开启了我的科研生活，感谢邱老师三年多的悉心教导，您渊博的学识、严谨的科研习惯、豁达的处世态度都深深地影响着我，您的话语至今仍萦绕耳边，引人深思、警醒，为我本硕期间学习生活指引着方向。邱老师常对我的课题进行指导和督促，坚持每周与我们开会讨论，听取相关研究进度汇报，帮助解决课题研究过程中遇到的问题和困难，启发我们如何突破困境。在此，向邱老师表达我由衷的感谢和诚挚的敬意。
其次，感谢我的师姐刘闽建、郭悦、师兄覃寰，感谢他们对我学业和生活上的细心指导，在我遇到困境和难题的时候耐心解答。感谢我的同门杨宇辰，感谢三年来互相扶持、共同探讨问题、解决问题。感谢我的师弟曹永杰、王小东、谢至臻、周梓浩，感谢他们在科研生活中的帮助和陪伴。感谢我的室友毛乃新、卢楠滟、赵银君、黄喜乐，感谢她们在低迷时的开导和陪伴、在欢乐时的友爱和温馨。回忆整个大学时光，与你们相遇、有你们相伴，都是莫大的幸运和福气。
此外，感谢我的队友任琪，感谢他在生活、学习、科研、心灵上的无限供应的扶持与包容。感谢他与我共喜怒哀乐、同酸甜苦辣，感谢他愿意接受我进入他的生活，也感谢他愿意加入我的生活，惟愿长长久久、但愿朝朝暮暮。凡事唯物，单单于他，希望来世。
最后，感谢我的父母和家人，感谢他们给予我学习和生活上无比巨大的支持和鼓舞，感谢他们义无反顾作为我最坚强的后盾，感谢他们让我始终生活在一个温暖和睦的家庭环境中，让我时刻感受到被人所爱，也让我学会表达爱、学会爱别人。谢谢你们，你们的平安顺遂是我最大的动力所在。
感谢母校华北电力大学。感谢评审老师提出的宝贵意见及建议。祝所有人前程似锦、平安顺心、事事如意！祝母校再续辉煌！

